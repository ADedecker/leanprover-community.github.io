---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/82898updatemathlib.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/82898updatemathlib.html">update-mathlib</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="164716125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/update-mathlib/near/164716125" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/82898updatemathlib.html#164716125">Johan Commelin (May 02 2019 at 15:09)</a>:</h4>
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span> How far are we from having <code>update-mathlib</code> work for mathlib itself (vs projects that depend on mathlib)?</p>

<a name="164716145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/update-mathlib/near/164716145" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/82898updatemathlib.html#164716145">Patrick Massot (May 02 2019 at 15:09)</a>:</h4>
<p>You have <code>cache-olean</code> for that</p>

<a name="164716229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/update-mathlib/near/164716229" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/82898updatemathlib.html#164716229">Johan Commelin (May 02 2019 at 15:10)</a>:</h4>
<p>Huh? Did I miss something?</p>

<a name="164716280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/update-mathlib/near/164716280" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/82898updatemathlib.html#164716280">Johan Commelin (May 02 2019 at 15:10)</a>:</h4>
<p>What is <code>cache-olean</code>? Where do I get it? How much does it cost?</p>

<a name="164716386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/update-mathlib/near/164716386" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/82898updatemathlib.html#164716386">Simon Hudon (May 02 2019 at 15:12)</a>:</h4>
<p>In mathlib, run <code>scripts/setup-dev-scripts.py</code></p>

<a name="164716430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/update-mathlib/near/164716430" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/82898updatemathlib.html#164716430">Simon Hudon (May 02 2019 at 15:12)</a>:</h4>
<p>then you can run <code>setup-lean-git-hooks</code> and you're all set</p>

<a name="164716493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/update-mathlib/near/164716493" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/82898updatemathlib.html#164716493">Simon Hudon (May 02 2019 at 15:13)</a>:</h4>
<p>It will cache your compiled files when you commit and will try to fetch things when you check out a branch. If the branch you're checking out has a nightly, it will use it</p>

<a name="164717538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/update-mathlib/near/164717538" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/82898updatemathlib.html#164717538">Johan Commelin (May 02 2019 at 15:24)</a>:</h4>
<p>Ok, so I ran <code>cache-olean --fetch</code> in my <code>mathlib</code> directory, and of course it didn't find a nightly on Github. Does this mean I will still have to recompile mathlib myself in 57% of the cases?</p>

<a name="164717656"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/update-mathlib/near/164717656" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/82898updatemathlib.html#164717656">Simon Hudon (May 02 2019 at 15:26)</a>:</h4>
<p>No way, more like 56% ...</p>

<a name="164717722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/update-mathlib/near/164717722" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/82898updatemathlib.html#164717722">Simon Hudon (May 02 2019 at 15:27)</a>:</h4>
<p>What you can do is find a version that does have a nightly, do <code>cache-olean --fetch</code> then checkout your branch and you should have less to rebuild</p>

<a name="164718806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/update-mathlib/near/164718806" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/82898updatemathlib.html#164718806">Johan Commelin (May 02 2019 at 15:40)</a>:</h4>
<p>Sure... that does help a bit. But if the latest commits touch some basic files in the hierarchy (which does happen quite often) it is the difference between recompiling 70% or 60% of mathlib...<br>
Anyway, I very much appreciate all the work you are doing to make these things easy for users. Maybe we can still find a place to host all these nightlies for us?</p>

<a name="164718861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/update-mathlib/near/164718861" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/82898updatemathlib.html#164718861">Johan Commelin (May 02 2019 at 15:41)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> Can't you just run a cronjob to all the new nightlies from github every day...? That solves the "pushing to your server" issue, right?</p>


{% endraw %}
