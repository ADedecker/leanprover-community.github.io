---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/81401setupupdatemathlibsh.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html">setup-update-mathlib.sh</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="161106953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161106953" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161106953">Scott Morrison (Mar 18 2019 at 23:42)</a>:</h4>
<p>Is there any documentation for <code>setup-update-mathlib.sh</code>? I ran it, but I'm not quite sure what to expect when I then run <code>update-mathlib</code>. Reading the code, I can see that it is for running in projects that have a dependency on <code>mathlib</code>. However, when I ran <code>update-mathlib</code> in a project with <code>leanpkg.toml</code> file:</p>
<div class="codehilite"><pre><span></span>[package]
name = &quot;ITP-2019&quot;
version = &quot;0.1&quot;
lean_version = &quot;nightly-2019-01-13&quot;
path = &quot;src&quot;

[dependencies]
mathlib = {git = &quot;https://github.com/leanprover-community/mathlib&quot;, branch = &quot;master&quot;, rev = &quot;f46f0a6719da61ff7daaa24b5cc1ec02bfb88ff3&quot;}
</pre></div>


<p>I just get the output </p>
<div class="codehilite"><pre><span></span>$ update-mathlib
Querying GitHub...
Error: no nightly archive found
</pre></div>


<p>Presumably I'm doing something wrong, and my <code>leanpkg.toml</code> is not "how it's meant to be".</p>

<a name="161106983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161106983" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161106983">Scott Morrison (Mar 18 2019 at 23:42)</a>:</h4>
<p>Should I change the <code>lean_version = ...</code> line? Should I remove the <code>branch = "master"</code> key in the dependencies section?</p>

<a name="161107091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107091" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107091">Simon Hudon (Mar 18 2019 at 23:44)</a>:</h4>
<p>select 3.4.2 as your lean version and do <code>leanpkg upgrade</code> first</p>

<a name="161107106"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107106" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107106">Scott Morrison (Mar 18 2019 at 23:44)</a>:</h4>
<p>Should I remove the <code>branch="master"</code> key then?</p>

<a name="161107199"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107199" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107199">Simon Hudon (Mar 18 2019 at 23:46)</a>:</h4>
<p>Yes, I believe so</p>

<a name="161107233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107233" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107233">Mario Carneiro (Mar 18 2019 at 23:47)</a>:</h4>
<p>I want to second this request for documentation. I don't like running scripts when I don't understand what they do, especially if they change my configuration data</p>

<a name="161107313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107313" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107313">Mario Carneiro (Mar 18 2019 at 23:48)</a>:</h4>
<p>Also I'm not talking about how to use the script, that's usually easy. I'm talking about what it is attempting to do specifically, what it looks for, and so on, so I can predict when and why it will fail</p>

<a name="161107543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107543" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107543">Scott Morrison (Mar 18 2019 at 23:53)</a>:</h4>
<p>Also --- is there hope to have <code>leanpkg upgrade</code> call <code>update-mathlib</code>?</p>

<a name="161107618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107618" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107618">Simon Hudon (Mar 18 2019 at 23:54)</a>:</h4>
<p>I'll get on the documentation. As for <code>leanpkg</code>, it's in the work. I was under the impression it wasn't wanted so I didn't put a high priority on it. I'll get back to it</p>

<a name="161107669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107669" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107669">Scott Morrison (Mar 18 2019 at 23:55)</a>:</h4>
<p>Thanks, <span class="user-mention" data-user-id="110026">@Simon Hudon</span>. I really appreciate this infrastructure work, and don't want to load too much stuff on your plate -- I could try writing some docs too (sometimes it's helpful if someone who doesn't actually understand stuff writes them :-)</p>

<a name="161107730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107730" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107730">Scott Morrison (Mar 18 2019 at 23:56)</a>:</h4>
<p>The other question about infrastructure I had is --- what are the prospects for downloading cached olean files when switching branches inside mathlib?</p>

<a name="161107740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107740" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107740">Scott Morrison (Mar 18 2019 at 23:56)</a>:</h4>
<p>This is still the killer for me.</p>

<a name="161107751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107751" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107751">Kevin Buzzard (Mar 18 2019 at 23:56)</a>:</h4>
<p>Me too, but I couldn't really envisage a solution.</p>

<a name="161107755"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107755" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107755">Kevin Buzzard (Mar 18 2019 at 23:56)</a>:</h4>
<p>if I'm editing algebra.group then I know I'm in for a certain amount of pain anyway</p>

<a name="161107861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107861" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107861">Scott Morrison (Mar 18 2019 at 23:58)</a>:</h4>
<p>From memory the two proposed solutions had just been:<br>
1) every time we switch branches, stash away all the olean files, and pull out the stashed olean files for the other branch (if any have previously been stashed).<br>
2) do everything mediated via <a href="https://github.com/mozilla/sccache" target="_blank" title="https://github.com/mozilla/sccache">sccache</a>.</p>

<a name="161107880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107880" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107880">Simon Hudon (Mar 18 2019 at 23:59)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> I would really appreciate your perspective on that. If you have time to do it, I'll fix any oversight or mistake</p>

<a name="161107886"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107886" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107886">Scott Morrison (Mar 18 2019 at 23:59)</a>:</h4>
<p>For 1, I think the problem was just that timestamps weren't working, and the deployed oleans weren't being used??</p>

<a name="161107895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107895" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107895">Scott Morrison (Mar 18 2019 at 23:59)</a>:</h4>
<p>For 2, I never understood enough to know what the obstacles were.</p>

<a name="161107981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161107981" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161107981">Simon Hudon (Mar 19 2019 at 00:00)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> That's right. I started over with 1) and started zipping the olean and lean files and hooking the cache into git. I still need to test more. I think I also need to integrate with <code>update-mathlib</code> when creating new branches from <code>master</code> or <code>lean-3.4.2</code></p>

<a name="161108026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161108026" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161108026">Scott Morrison (Mar 19 2019 at 00:01)</a>:</h4>
<p>Having option 1) would be really helpful.</p>

<a name="161108087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161108087" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161108087">Simon Hudon (Mar 19 2019 at 00:02)</a>:</h4>
<p>for 2), I did some work, it proved harder and less reliable than I hoped so I put it aside</p>

<a name="161108149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161108149" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161108149">Scott Morrison (Mar 19 2019 at 00:03)</a>:</h4>
<p>Great to know --- 2) did sound daunting; sccache was going to require us to jump through their hoops.</p>

<a name="161108204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161108204" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161108204">Simon Hudon (Mar 19 2019 at 00:04)</a>:</h4>
<p>That's true. 1) might end up easier to use</p>

<a name="161989597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161989597" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161989597">Bryan Gin-ge Chen (Mar 28 2019 at 20:26)</a>:</h4>
<p>I'm having trouble with <code>update-mathlib</code>:</p>
<div class="codehilite"><pre><span></span>Traceback (most recent call last):
  File &quot;/Users/chb/.mathlib/bin/update-mathlib&quot;, line 21, in auth_github
    return Github(config.get(&#39;github&#39;, &#39;user&#39;), config.get(&#39;github&#39;, &#39;password&#39;))
  File &quot;/Users/chb/Library/Python/3.7/lib/python/site-packages/git/config.py&quot;, line 79, in assure_data_present
    return func(self, *args, **kwargs)
  File &quot;/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/configparser.py&quot;, line 780, in get
    d = self._unify_values(section, vars)
  File &quot;/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/configparser.py&quot;, line 1146, in _unify_values
    raise NoSectionError(section) from None
configparser.NoSectionError: No section: &#39;github&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File &quot;/Users/chb/.mathlib/bin/update-mathlib&quot;, line 63, in &lt;module&gt;
    g = auth_github()
  File &quot;/Users/chb/.mathlib/bin/update-mathlib&quot;, line 22, in auth_github
    except configparser.NoOptionError:
NameError: name &#39;configparser&#39; is not defined
</pre></div>


<p>Am I supposed to have my github username and password stored in my git config somehow?</p>

<a name="161989660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161989660" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161989660">Simon Hudon (Mar 28 2019 at 20:27)</a>:</h4>
<p>It would help but it's not supposed to fail if it's not there. Let me just have a look</p>

<a name="161989711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161989711" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161989711">Bryan Gin-ge Chen (Mar 28 2019 at 20:28)</a>:</h4>
<p>Right now I authenticate using an SSH key which is stored in the macOS keychain.</p>

<a name="161990065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161990065" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161990065">Simon Hudon (Mar 28 2019 at 20:32)</a>:</h4>
<p>Can you try again?</p>

<a name="161990321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161990321" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161990321">Bryan Gin-ge Chen (Mar 28 2019 at 20:35)</a>:</h4>
<div class="codehilite"><pre><span></span>  File &quot;/Users/chb/.mathlib/bin/update-mathlib&quot;, line 24
    continue
    ^
SyntaxError: &#39;continue&#39; not properly in loop
</pre></div>

<a name="161992211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161992211" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161992211">Scott Morrison (Mar 28 2019 at 20:59)</a>:</h4>
<p>Oh ---- I'd thought I'd updated this code, but it turns out it is repeated across <code>update-mathlib.py</code> and <code>cache-olean.py</code>, and only the second was updated.</p>

<a name="161992226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161992226" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161992226">Scott Morrison (Mar 28 2019 at 20:59)</a>:</h4>
<p>We should factor that out into a module, and import it in both files.</p>

<a name="161992342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161992342" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161992342">Scott Morrison (Mar 28 2019 at 21:00)</a>:</h4>
<p>Similarly, <code>update-mathlib.py</code> should use the ctrl-c protection on file operations that I put into <code>cache-olean.py</code> (in <a href="https://github.com/leanprover-community/mathlib/issues/858" target="_blank" title="https://github.com/leanprover-community/mathlib/issues/858">#858</a>).</p>

<a name="161992359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/161992359" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#161992359">Scott Morrison (Mar 28 2019 at 21:00)</a>:</h4>
<p>I won't have a chance to do any of this until the weekend.</p>

<a name="162001730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/162001730" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#162001730">Simon Hudon (Mar 28 2019 at 23:17)</a>:</h4>
<p><span class="user-mention" data-user-id="123965">@Bryan Gin-ge Chen</span> I tried a quick fix (copy pasting with <span class="user-mention" data-user-id="110087">@Scott Morrison</span> put in <code>cache-olean.py</code>). When you can, please try again.</p>

<a name="162003691"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/162003691" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#162003691">Bryan Gin-ge Chen (Mar 28 2019 at 23:47)</a>:</h4>
<p>Still no luck. I think this is the same error as I originally had:</p>
<div class="codehilite"><pre><span></span>Traceback (most recent call last):
  File &quot;/Users/chb/.mathlib/bin/update-mathlib&quot;, line 21, in auth_github
    return Github(config.get(&#39;github&#39;, &#39;user&#39;), config.get(&#39;github&#39;, &#39;password&#39;))
  File &quot;/Users/chb/Library/Python/3.7/lib/python/site-packages/git/config.py&quot;, line 79, in assure_data_present
    return func(self, *args, **kwargs)
  File &quot;/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/configparser.py&quot;, line 780, in get
    d = self._unify_values(section, vars)
  File &quot;/usr/local/Cellar/python/3.7.3/Frameworks/Python.framework/Versions/3.7/lib/python3.7/configparser.py&quot;, line 1146, in _unify_values
    raise NoSectionError(section) from None
configparser.NoSectionError: No section: &#39;github&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File &quot;/Users/chb/.mathlib/bin/update-mathlib&quot;, line 66, in &lt;module&gt;
    g = auth_github()
  File &quot;/Users/chb/.mathlib/bin/update-mathlib&quot;, line 22, in auth_github
    except configparser.NoSectionError:
NameError: name &#39;configparser&#39; is not defined
</pre></div>

<a name="162004847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/162004847" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#162004847">Simon Hudon (Mar 29 2019 at 00:06)</a>:</h4>
<p>I'm hoping this time I tested it properly</p>

<a name="162005016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/162005016" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#162005016">Bryan Gin-ge Chen (Mar 29 2019 at 00:09)</a>:</h4>
<p>OK, this seems like progress:</p>
<div class="codehilite"><pre><span></span>No github section found in &#39;git config&#39;
Querying GitHub...
Error: no nightly archive found
</pre></div>

<a name="162005098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/162005098" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#162005098">Simon Hudon (Mar 29 2019 at 00:10)</a>:</h4>
<p>ok good</p>

<a name="162005108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/162005108" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#162005108">Simon Hudon (Mar 29 2019 at 00:10)</a>:</h4>
<p>Now try <code>leanpkg upgrade</code> it will give you the latest version in the <code>lean-3.4.2</code> branch which always has a nightly associated</p>

<a name="162005110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/162005110" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#162005110">Simon Hudon (Mar 29 2019 at 00:10)</a>:</h4>
<p>Then <code>update-mathlib</code></p>

<a name="162005921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/162005921" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#162005921">Bryan Gin-ge Chen (Mar 29 2019 at 00:26)</a>:</h4>
<p>OK, I think it's finally working! Thanks!</p>
<p>What's recommended for <code>lean_version</code> <code>leanpkg.toml</code> now? I've been using <code>nightly</code> there, which at least gets <code>leanpkg upgrade</code> to pull the latest commit of mathlib, though it also gives me this warning every time:</p>
<div class="codehilite"><pre><span></span>WARNING: Lean version mismatch: installed version is nightly-2019-01-13, but package requires nightly
</pre></div>


<p>When I use <code>3.4.2</code> as the version string, <code>leanpkg upgrade</code> used to pull a really old commit, though it looks like now it's just a few days old.</p>

<a name="162005943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/162005943" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#162005943">Bryan Gin-ge Chen (Mar 29 2019 at 00:27)</a>:</h4>
<p>I think things happened to work for me just now because the latest nightly at <code>mathlib-nightly</code> just came out with the same tag as the most recent commit to mathlib.</p>

<a name="162006527"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/162006527" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#162006527">Simon Hudon (Mar 29 2019 at 00:40)</a>:</h4>
<p>Travis updates the <code>lean-3.4.2</code> branch every time it uploads a nightly build so <code>lean_version = 3.4.2</code> is the recommended setting.</p>

<a name="162006762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/setup-update-mathlib.sh/near/162006762" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/81401setupupdatemathlibsh.html#162006762">Bryan Gin-ge Chen (Mar 29 2019 at 00:45)</a>:</h4>
<p>Does it usually take a while? The <code>lean-3.4.2</code> branch is currently pointing to commit <code>291a4f3</code> which is <code>nightly-2019-03-25</code>.</p>


{% endraw %}
