---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/12770VScodemessagewindow.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/12770VScodemessagewindow.html">VScode message window</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="188082215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/VScode%20message%20window/near/188082215" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/12770VScodemessagewindow.html#188082215">Johan Commelin (Feb 13 2020 at 06:39)</a>:</h4>
<p>We now have several tactics that report back with tactic scripts in the Lean messages window: <code>squeeze_simp</code>, <code>tidy?</code>, <code>suggest</code>, <code>extract_goal</code> and in a couple of days <code>hint</code>. Would it be possible to hit <code>C-x</code> <code>M-c</code> <code>M-butterfly</code> and magically have the tactic-script-reporting-tactic under the cursor be replaces with whatever tactic script it reported?<br>
I understand that maybe this would require that the tactic script reports follow a common output format, but that shouldn't be hard.</p>
<p>In principle hole commands would do this. But in practice, that doesn't seem to work. (They work great for dumping a skeleton of a structure, and things like that.) For one, the hole command wouldn't let you inspect the reported script, before hitting the magic keyboard combo.</p>

<a name="188189541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/VScode%20message%20window/near/188189541" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/12770VScodemessagewindow.html#188189541">Alexander Bentkamp (Feb 14 2020 at 09:14)</a>:</h4>
<p>I thought this would be a good opportunity for me to experiment with the VSCode extension. I already have something now that kind of works:</p>
<p><a href="https://github.com/leanprover/vscode-lean/pull/143" target="_blank" title="https://github.com/leanprover/vscode-lean/pull/143">https://github.com/leanprover/vscode-lean/pull/143</a></p>
<p>For now, it copies the entire message of the tactic (which is what we want for the current implementation of <code>squeeze_simp</code>) and replaces the current selection (i.e., you need to select the characters <code>squeeze_simp</code> in your editor before you press the key combination for this to work properly). So there is a lot of room for improvement :-)</p>

<a name="188189731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/VScode%20message%20window/near/188189731" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/12770VScodemessagewindow.html#188189731">Johan Commelin (Feb 14 2020 at 09:17)</a>:</h4>
<p>That's already really nice</p>

<a name="188189885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/VScode%20message%20window/near/188189885" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/12770VScodemessagewindow.html#188189885">Alexander Bentkamp (Feb 14 2020 at 09:18)</a>:</h4>
<p>What would be the best key combination for this? I currently have <code>alt+v</code>. (<code>v</code> like pasting in <code>ctrl+v</code>)</p>

<a name="188190046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/VScode%20message%20window/near/188190046" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/12770VScodemessagewindow.html#188190046">Alexander Bentkamp (Feb 14 2020 at 09:21)</a>:</h4>
<p>And what should be the format for the tactic output? We could change squeeze_simp to say:</p>
<div class="codehilite"><pre><span></span>Try this: simp only [foo, bar]
</pre></div>


<p>This is what Isabelle/Sledgehammer says, too. Then the words "Try this:" could be recognized by the extension.</p>

<a name="188209987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/VScode%20message%20window/near/188209987" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/12770VScodemessagewindow.html#188209987">Gabriel Ebner (Feb 14 2020 at 14:24)</a>:</h4>
<p>This is a great idea!</p>
<ul>
<li>There should really be a magic string like <code>Try this:</code> that is recognized by the extension.  You should also be able to print additional stuff from the tactic before/after the <code>Try this:</code>.</li>
<li>You shouldn't have to select the tactic invocation before calling alt+v.  There is no way to obtain the range of the tactic (i.e. where <code>squeeze_simp</code> or <code>library_search</code> is in the file).  But as a first heuristic, just selecting everything from the position of the message until the end of the line (or the next comma) should work in most cases.</li>
</ul>

<a name="188210070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/VScode%20message%20window/near/188210070" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/12770VScodemessagewindow.html#188210070">Gabriel Ebner (Feb 14 2020 at 14:25)</a>:</h4>
<p>If this works nicely, I'd also like to integrate it in the info view, so that you can click on the <code>Try this:</code> (or some button right next to it).</p>

<a name="188528964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/VScode%20message%20window/near/188528964" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/12770VScodemessagewindow.html#188528964">Rob Lewis (Feb 19 2020 at 09:43)</a>:</h4>
<p>A very minor bug report/feature request: when you use this on a tactic call with a trailing comma, it deletes the comma. Would it be possible to replace until the next unbracketed comma instead of the end of the line? Or is there an ambiguity there I'm not seeing?</p>

<a name="188528980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/VScode%20message%20window/near/188528980" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/12770VScodemessagewindow.html#188528980">Rob Lewis (Feb 19 2020 at 09:43)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">‚Ñù</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">-</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">squeeze_simp</span><span class="o">,</span> <span class="c1">-- inserting the suggestion breaks the proof</span>
  <span class="n">exact</span> <span class="n">h</span>
<span class="kn">end</span>
</pre></div>


{% endraw %}

{% include archive_update.html %}