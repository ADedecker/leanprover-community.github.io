---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/62589newmathlibtools.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html">new mathlib tools</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="188884880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188884880" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188884880">Patrick Massot (Feb 23 2020 at 21:19)</a>:</h4>
<p>I need infrastructure testers again. This thread is for you if you want to help users, especially beginners, and you have a working elan+python3+pip installation (and are not afraid of temporarily screwing up your mathlib tools). The install procedure is:</p>
<ul>
<li><code>git clone https://github.com/leanprover-community/mathlib-tools.git</code> if you don't already have it</li>
<li><code>cd mathlib-tools</code></li>
<li><code>git checkout refactor</code></li>
<li>
<p><code>sudo pip3 install .</code><br>
Then you should have a brand new <code>leancli</code> toy (whose name is up for discussion). It is meant to replace <code>leanpkg</code>+<code>update-mathlib</code>+<code>cache_olean</code> except that one task corresponds to one command. Things to try out:</p>
</li>
<li>
<p><code>leancli new myprojet</code> should create a new lean project with mathlib ready to go.</p>
</li>
<li>in a project depending on mathlib, <code>leancli upgrade-mathlib</code> should upgrade mathlib, including oleans</li>
<li>in mathlib, <code>leancli upgrade-mathlib</code> should upgrade mathlib, including oleans</li>
<li>in a project not depending on mathlib (?!),  <code>leancli add-mathlib</code> should make it a decent Lean project, including oleans</li>
<li>in any project, <code>leancli mk-cache</code> and <code>lean-cli get-cache</code> should make and fetch olean cache. If this project is mathlib, that cache will live in <code>$HOME/.mathlib</code>, else it will live in <code>_cache</code> in the project</li>
<li>in any project, <code>leancli build</code> should do a <code>leanpkg build</code></li>
<li>in any project, <code>leancli hooks</code> should do what <code>setup-git-hooks</code> used to do</li>
<li><code>leancli get tutorials</code> should give you the tutorials project, ready to use (alternative commands: <code>leancli get leanprover-community/tutorials</code> or <code>leancli get https://github.com/leanprover-community/tutorials.git</code>)</li>
</ul>

<a name="188888476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188888476" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188888476">Kevin Buzzard (Feb 23 2020 at 23:10)</a>:</h4>
<p><code>leancli new myprojet</code> seems to work for me on Ubuntu 18.04, but probably that was the least of your worries.</p>

<a name="188889734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188889734" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188889734">Patrick Massot (Feb 23 2020 at 23:50)</a>:</h4>
<p>This is still good to know!</p>

<a name="188889975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188889975" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188889975">Alex J. Best (Feb 23 2020 at 23:59)</a>:</h4>
<p>On OSX: making  new project works fine! When I go to mathlib and run <code>leancli upgrade-mathlib</code> (why did the name change from <code>update-mathlib</code>?) I get:</p>
<div class="codehilite"><pre><span></span>+alex:~/mathlib ((bcb63ebf...)) üêå leancli upgrade-mathlib
Traceback (most recent call last):
  File &quot;/usr/local/bin/leancli&quot;, line 8, in &lt;module&gt;
    sys.exit(main())
  File &quot;/usr/local/lib/python3.7/site-packages/mathlibtools/leancli.py&quot;, line 75, in main
    &#39;hooks&#39;: hooks,
  File &quot;/usr/local/lib/python3.7/site-packages/fire/core.py&quot;, line 138, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File &quot;/usr/local/lib/python3.7/site-packages/fire/core.py&quot;, line 471, in _Fire
    target=component.__name__)
  File &quot;/usr/local/lib/python3.7/site-packages/fire/core.py&quot;, line 675, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File &quot;/usr/local/lib/python3.7/site-packages/mathlibtools/leancli.py&quot;, line 26, in upgrade_mathlib
    proj().upgrade_mathlib()
  File &quot;/usr/local/lib/python3.7/site-packages/mathlibtools/leanproject.py&quot;, line 306, in upgrade_mathlib
    rem = next(remote for remote in self.repo.remotes
StopIteration
</pre></div>

<a name="188890180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188890180" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188890180">Alex J. Best (Feb 24 2020 at 00:03)</a>:</h4>
<p>I believe this is my bad for having my mathlib remote url still pointing to <code>https://github.com/leanprover/mathlib.git</code>  which is the old url</p>

<a name="188890186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188890186" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188890186">Alex J. Best (Feb 24 2020 at 00:03)</a>:</h4>
<p>But probably this situation should still be handled either with a nice error message, or it shouldn't be too hard to make this url work too.</p>

<a name="188890234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188890234" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188890234">Alex J. Best (Feb 24 2020 at 00:04)</a>:</h4>
<p>e.g. "You do not appear to have <code>leanprover-community/mathlib</code> as a remote for this repository. Are you sure you are in a mathlib repository?"</p>

<a name="188890438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188890438" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188890438">Alex J. Best (Feb 24 2020 at 00:09)</a>:</h4>
<p>After fixing that and making sure I was on the <code>lean-3.5.1</code> branch it looks to work.<br>
One annoyance is that I usually checkout <code>origin/lean-3.5.1</code> which makes it error, maybe that was bad practice on my account still.</p>


{% endraw %}

{% include archive_update.html %}