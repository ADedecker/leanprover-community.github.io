---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/62589newmathlibtools.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html">new mathlib tools</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="188884880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188884880" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188884880">Patrick Massot (Feb 23 2020 at 21:19)</a>:</h4>
<p>I need infrastructure testers again. This thread is for you if you want to help users, especially beginners, and you have a working elan+python3+pip installation (and are not afraid of temporarily screwing up your mathlib tools). The install procedure is:</p>
<ul>
<li><code>git clone https://github.com/leanprover-community/mathlib-tools.git</code> if you don't already have it</li>
<li><code>cd mathlib-tools</code></li>
<li><code>git checkout refactor</code></li>
<li>
<p><code>sudo pip3 install .</code><br>
Then you should have a brand new <code>leancli</code> toy (whose name is up for discussion). It is meant to replace <code>leanpkg</code>+<code>update-mathlib</code>+<code>cache_olean</code> except that one task corresponds to one command. Things to try out:</p>
</li>
<li>
<p><code>leancli new myprojet</code> should create a new lean project with mathlib ready to go.</p>
</li>
<li>in a project depending on mathlib, <code>leancli upgrade-mathlib</code> should upgrade mathlib, including oleans</li>
<li>in mathlib, <code>leancli upgrade-mathlib</code> should upgrade mathlib, including oleans</li>
<li>in a project not depending on mathlib (?!),  <code>leancli add-mathlib</code> should make it a decent Lean project, including oleans</li>
<li>in any project, <code>leancli mk-cache</code> and <code>lean-cli get-cache</code> should make and fetch olean cache. If this project is mathlib, that cache will live in <code>$HOME/.mathlib</code>, else it will live in <code>_cache</code> in the project</li>
<li>in any project, <code>leancli build</code> should do a <code>leanpkg build</code></li>
<li>in any project, <code>leancli hooks</code> should do what <code>setup-git-hooks</code> used to do</li>
<li><code>leancli get tutorials</code> should give you the tutorials project, ready to use (alternative commands: <code>leancli get leanprover-community/tutorials</code> or <code>leancli get https://github.com/leanprover-community/tutorials.git</code>)</li>
</ul>

<a name="188888476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188888476" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188888476">Kevin Buzzard (Feb 23 2020 at 23:10)</a>:</h4>
<p><code>leancli new myprojet</code> seems to work for me on Ubuntu 18.04, but probably that was the least of your worries.</p>

<a name="188889734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188889734" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188889734">Patrick Massot (Feb 23 2020 at 23:50)</a>:</h4>
<p>This is still good to know!</p>

<a name="188889975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188889975" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188889975">Alex J. Best (Feb 23 2020 at 23:59)</a>:</h4>
<p>On OSX: making  new project works fine! When I go to mathlib and run <code>leancli upgrade-mathlib</code> (why did the name change from <code>update-mathlib</code>?) I get:</p>
<div class="codehilite"><pre><span></span>+alex:~/mathlib ((bcb63ebf...)) üêå leancli upgrade-mathlib
Traceback (most recent call last):
  File &quot;/usr/local/bin/leancli&quot;, line 8, in &lt;module&gt;
    sys.exit(main())
  File &quot;/usr/local/lib/python3.7/site-packages/mathlibtools/leancli.py&quot;, line 75, in main
    &#39;hooks&#39;: hooks,
  File &quot;/usr/local/lib/python3.7/site-packages/fire/core.py&quot;, line 138, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File &quot;/usr/local/lib/python3.7/site-packages/fire/core.py&quot;, line 471, in _Fire
    target=component.__name__)
  File &quot;/usr/local/lib/python3.7/site-packages/fire/core.py&quot;, line 675, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File &quot;/usr/local/lib/python3.7/site-packages/mathlibtools/leancli.py&quot;, line 26, in upgrade_mathlib
    proj().upgrade_mathlib()
  File &quot;/usr/local/lib/python3.7/site-packages/mathlibtools/leanproject.py&quot;, line 306, in upgrade_mathlib
    rem = next(remote for remote in self.repo.remotes
StopIteration
</pre></div>

<a name="188890180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188890180" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188890180">Alex J. Best (Feb 24 2020 at 00:03)</a>:</h4>
<p>I believe this is my bad for having my mathlib remote url still pointing to <code>https://github.com/leanprover/mathlib.git</code>  which is the old url</p>

<a name="188890186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188890186" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188890186">Alex J. Best (Feb 24 2020 at 00:03)</a>:</h4>
<p>But probably this situation should still be handled either with a nice error message, or it shouldn't be too hard to make this url work too.</p>

<a name="188890234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188890234" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188890234">Alex J. Best (Feb 24 2020 at 00:04)</a>:</h4>
<p>e.g. "You do not appear to have <code>leanprover-community/mathlib</code> as a remote for this repository. Are you sure you are in a mathlib repository?"</p>

<a name="188890438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188890438" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188890438">Alex J. Best (Feb 24 2020 at 00:09)</a>:</h4>
<p>After fixing that and making sure I was on the <code>lean-3.5.1</code> branch it looks to work.<br>
One annoyance is that I usually checkout <code>origin/lean-3.5.1</code> which makes it error, maybe that was bad practice on my account still.</p>

<a name="188905857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188905857" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188905857">Patrick Massot (Feb 24 2020 at 07:47)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="127136">@Alex J. Best</span>. About the upgrade name: this mess comes from the discrepancy between the existing <code>leanpkg upgrade</code> and <code>update-mathlib</code>. But I think I'll introduce aliases so that <code>leancli upgrade-mathlib</code>, <code>leancli update-mathlib</code> and <code>leancli up</code> all do the same.</p>

<a name="188905927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188905927" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188905927">Patrick Massot (Feb 24 2020 at 07:49)</a>:</h4>
<p>About git pulling mathlib, this is clearly the trickiest part, because there can be a wild diversity of git situations. I'll add a couple more heuristics, but the documentation will need to point out that, if you are in a weird setup, you can always do <code>git pull whatever &amp;&amp; leancli get-cache</code>.</p>

<a name="188905954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188905954" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188905954">Patrick Massot (Feb 24 2020 at 07:49)</a>:</h4>
<p>It would be nice to have tests on Windows as well. By <span class="user-mention" data-user-id="110596">@Rob Lewis</span> or <span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span> maybe?</p>

<a name="188906019"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188906019" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188906019">Patrick Massot (Feb 24 2020 at 07:50)</a>:</h4>
<p>Also I think <span class="user-mention" data-user-id="110087">@Scott Morrison</span> recently complained about API rate limit errors. Would you mind trying this brand new toy which should never hit that error (unless you ask for ancient nightlies).</p>

<a name="188911964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188911964" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188911964">Rob Lewis (Feb 24 2020 at 09:48)</a>:</h4>
<p>Thanks Patrick! I haven't tried it yet but this looks very nice. Can I bikeshed about the name? <code>leancli</code> sounds kind of awkward. What about <code>leanproject</code>? (Or <code>lean-project</code>?)</p>

<a name="188912009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188912009" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188912009">Johan Commelin (Feb 24 2020 at 09:48)</a>:</h4>
<p><code>cliean</code>?</p>

<a name="188914214"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188914214" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188914214">Gabriel Ebner (Feb 24 2020 at 10:24)</a>:</h4>
<p>I can confirm that <code>leancli get-cache</code> works for me.  Regarding the name: since we already have all kinds of puns (<code>elan</code>, <code>trepplein</code>, lean forward, lean together, etc.), how about <code>penche</code>?</p>

<a name="188921285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188921285" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188921285">Vaibhav Karve (Feb 24 2020 at 12:36)</a>:</h4>
<p>Another name suggestion: <code>cline</code>.</p>

<a name="188921507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188921507" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188921507">Patrick Massot (Feb 24 2020 at 12:39)</a>:</h4>
<p>As I wrote in the first message of this thread, the name is definitely open for bike-shedding. But I don't get the pun with <code>penche</code>.</p>

<a name="188921614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188921614" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188921614">Gabriel Ebner (Feb 24 2020 at 12:41)</a>:</h4>
<p>According to my French dictionary, "pencher" means "to lean".</p>

<a name="188921618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188921618" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188921618">Patrick Massot (Feb 24 2020 at 12:41)</a>:</h4>
<p>Are there other remarks about how the tools work? I was teaching this morning, and at 2 I'll go back to teach for three hours, so you all have time for testing.</p>

<a name="188921669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188921669" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188921669">Patrick Massot (Feb 24 2020 at 12:42)</a>:</h4>
<p>Oh, I didn't even think to try to read it as French.</p>

<a name="188921676"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188921676" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188921676">Patrick Massot (Feb 24 2020 at 12:42)</a>:</h4>
<p>Ok, so it does work.</p>

<a name="188921700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188921700" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188921700">Johan Commelin (Feb 24 2020 at 12:42)</a>:</h4>
<p>What is "lean" as in "thin" in French?</p>

<a name="188921715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188921715" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188921715">Patrick Massot (Feb 24 2020 at 12:43)</a>:</h4>
<p>"mince" or "svelte"</p>

<a name="188921734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188921734" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188921734">Patrick Massot (Feb 24 2020 at 12:43)</a>:</h4>
<p>depending on context</p>

<a name="188921762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188921762" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188921762">Johan Commelin (Feb 24 2020 at 12:43)</a>:</h4>
<p>Ha, <code>mince</code> sounds like you're try to turn the olean files into minced meat or something (-;</p>

<a name="188922090"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188922090" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188922090">Anne Baanen (Feb 24 2020 at 12:48)</a>:</h4>
<p>How about <code>fuzhou</code>, apparently the name of a prefecture in China which contains Le'an County?</p>

<a name="188922444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188922444" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188922444">Gabriel Ebner (Feb 24 2020 at 12:53)</a>:</h4>
<blockquote>
<p>Le'an County</p>
</blockquote>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> for <code>‰πêÂÆâ new-project</code>, this reduces the risk of name collision.</p>

<a name="188928748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188928748" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188928748">Rob Lewis (Feb 24 2020 at 14:09)</a>:</h4>
<p>It's certainly more boring than <code>‰πêÂÆâ</code>, but the grammar of <code>leanproject</code> sounds nice. <code>leanproject new</code>, <code>leanproject upgrade-mathlib</code>, <code>leanproject fetch-cache</code>. When you have supporting tools that are going in peoples' paths, I think it's nice to make the name obviously connect to the main tool. If someone installed this and forgot about it, they'd have no idea after a while that <code>penche</code> and <code>lean</code> were connected.</p>

<a name="188946401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188946401" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188946401">Patrick Massot (Feb 24 2020 at 17:21)</a>:</h4>
<p>He, let's name that <code>leanproject</code>. Should I make a couple of fixes and open a PR to mathlib-tools or are there still people who want to test this or ask for different features? Are there people who would miss the current <code>update-mathlib</code>, <code>cache-olean</code> and <code>setup-git-hooks</code>? Or course <code>leanpkg</code> will stay, even if its direct use will be somehow deprecated.</p>

<a name="188946506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188946506" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188946506">Johan Commelin (Feb 24 2020 at 17:22)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> Thanks a lot for investing time in building this tool</p>

<a name="188950445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188950445" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188950445">Sebastien Gouezel (Feb 24 2020 at 18:07)</a>:</h4>
<p>I just got a failure</p>
<div class="codehilite"><pre><span></span>PS C:\Users\sebas\Desktop\mathlib_master - Copie&gt; leancli upgrade-mathlib
Looking for local mathlib oleans
Looking for Azure mathlib oleans
Trying to download https://oleanstorage.blob.core.windows.net/mathlib/8030469cccb4306230015df55ba50a5e280727bf.tar.gz¬†to C:\Users\sebas\.mathlib\8030469cccb4306230015df55ba50a5e280727bf.tar.gz
Traceback (most recent call last):
  File &quot;C:\Program Files\Python37\Scripts\leancli-script.py&quot;, line 11, in &lt;module&gt;
    load_entry_point(&#39;mathlibtools==0.0.3&#39;, &#39;console_scripts&#39;, &#39;leancli&#39;)()
  File &quot;c:\program files\python37\lib\site-packages\mathlibtools\leancli.py&quot;, line 75, in main
    &#39;hooks&#39;: hooks,
  File &quot;c:\program files\python37\lib\site-packages\fire\core.py&quot;, line 138, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File &quot;c:\program files\python37\lib\site-packages\fire\core.py&quot;, line 471, in _Fire
    target=component.__name__)
  File &quot;c:\program files\python37\lib\site-packages\fire\core.py&quot;, line 675, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File &quot;c:\program files\python37\lib\site-packages\mathlibtools\leancli.py&quot;, line 26, in upgrade_mathlib
    proj().upgrade_mathlib()
  File &quot;c:\program files\python37\lib\site-packages\mathlibtools\leanproject.py&quot;, line 317, in upgrade_mathlib
    self.get_mathlib_olean()
  File &quot;c:\program files\python37\lib\site-packages\mathlibtools\leanproject.py&quot;, line 227, in get_mathlib_olean
    unpack_archive(get_mathlib_archive(self.mathlib_rev),
  File &quot;c:\program files\python37\lib\site-packages\mathlibtools\leanproject.py&quot;, line 117, in get_mathlib_archive
    download(AZURE_URL+fname, path)
  File &quot;c:\program files\python37\lib\site-packages\mathlibtools\leanproject.py&quot;, line 96, in download
    with target.open(&#39;wb&#39;) as tgt:
  File &quot;c:\program files\python37\lib\pathlib.py&quot;, line 1165, in open
    opener=self._opener)
  File &quot;c:\program files\python37\lib\pathlib.py&quot;, line 1019, in _opener
    return self._accessor.open(self, flags, mode)
FileNotFoundError: [Errno 2] No such file or directory: &#39;C:\\Users\\sebas\\.mathlib\\8030469cccb4306230015df55ba50a5e280727bf.tar.gz&#39;
</pre></div>


<p>I then created by hand the directory <code>'C:\\Users\\sebas\\.mathlib</code> and tried again, and it worked.</p>

<a name="188955427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188955427" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188955427">Mario Carneiro (Feb 24 2020 at 19:04)</a>:</h4>
<p>It seems like the error reporting situation here is not great. When a big script like this fails I have no idea how to recover or what alternative steps to take</p>

<a name="188955569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188955569" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188955569">Mario Carneiro (Feb 24 2020 at 19:06)</a>:</h4>
<p>Could you maybe sprinkle some <code>try:</code> around in the code and explain to the user what went wrong? User facing errors are not supposed to be stackdumps</p>

<a name="188955646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188955646" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188955646">Patrick Massot (Feb 24 2020 at 19:07)</a>:</h4>
<p>Sure. We are at the testing phase where I do need to see tracebacks (not stackdumps...). But then I'll hide all that.</p>

<a name="188961334"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188961334" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188961334">Gabriel Ebner (Feb 24 2020 at 20:11)</a>:</h4>
<blockquote>
<p>Or course leanpkg will stay</p>
</blockquote>
<p><code>leanpkg</code> doesn't do anything magic.  There's nothing to stop you from replacing parts or all of it within <code>leanproject</code> if you want.</p>

<a name="188961454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188961454" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188961454">Patrick Massot (Feb 24 2020 at 20:12)</a>:</h4>
<p>I could avoid calling it from <code>leanproject</code>, but I guess we shouldn't remove it from <code>leanprover-community/lean</code></p>

<a name="188968273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188968273" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188968273">Patrick Massot (Feb 24 2020 at 21:31)</a>:</h4>
<p>I pushed a new version. Everybody is welcome to test (again). Please see the first message in this thread, except that <code>leancli</code> is now called <code>leanproject</code>.</p>

<a name="188968600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188968600" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188968600">Patrick Massot (Feb 24 2020 at 21:35)</a>:</h4>
<p>Note that <code>leanproject up</code> will have a hard time working on mathlib master. It may pull the lastest commit on master before CI builds it and pushes it to the cloud.</p>

<a name="188970878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188970878" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188970878">Patrick Massot (Feb 24 2020 at 22:01)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib-tools/pull/16" target="_blank" title="https://github.com/leanprover-community/mathlib-tools/pull/16">https://github.com/leanprover-community/mathlib-tools/pull/16</a></p>

<a name="188970918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188970918" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188970918">Patrick Massot (Feb 24 2020 at 22:01)</a>:</h4>
<p>Now is a good time to test!</p>

<a name="188971114"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188971114" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188971114">Patrick Massot (Feb 24 2020 at 22:03)</a>:</h4>
<p>Oh, CI fails. I haven't modified any CI instructions. Is anyone familiar with CI on this repository and could try to port it to the new system?</p>

<a name="188971239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188971239" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188971239">Patrick Massot (Feb 24 2020 at 22:05)</a>:</h4>
<p>Note that the PR does include tests, ran by tox against python 3.5, 3.6, 3.7 and 3.8.</p>

<a name="188971356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188971356" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188971356">Patrick Massot (Feb 24 2020 at 22:06)</a>:</h4>
<p>I'll work on this CI tomorrow if nobody does it while I sleep, but everybody can already test by cloning the branch and installing. And everybody can review the python code.</p>

<a name="188972968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188972968" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188972968">Scott Morrison (Feb 24 2020 at 22:26)</a>:</h4>
<p>Is the intention to eventually drop the separate repository, and just include this tool in the main (community) lean repository?</p>

<a name="188972996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188972996" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188972996">Patrick Massot (Feb 24 2020 at 22:27)</a>:</h4>
<p>I don't know. I don't remember why we separated this repository.</p>

<a name="188974432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188974432" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188974432">Simon Hudon (Feb 24 2020 at 22:46)</a>:</h4>
<p>We separated it because of how different the testing of the tools was from testing the mathlib PRs and it caused the mathlib builds to fail for unforeseen reasons</p>

<a name="188974807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188974807" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188974807">Patrick Massot (Feb 24 2020 at 22:51)</a>:</h4>
<p>Sounds reasonable.</p>

<a name="188998727"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188998727" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188998727">Johan Commelin (Feb 25 2020 at 08:04)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> When I run <code>leanproject get-cache</code> I get</p>
<div class="codehilite"><pre><span></span>Trying to download https://oleanstorage.blob.core.windows.net/mathlib/5770369f6d3f28356be20931c9ade07be37a01ad.tar.gz¬†to /home/jmc/.mathlib/5770369f6d3f28356be20931c9ade07be37a01ad.tar.gz
</pre></div>


<p>That's still the older slower URL, right?</p>

<a name="188998753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/188998753" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#188998753">Johan Commelin (Feb 25 2020 at 08:04)</a>:</h4>
<p>Also, should <code>leanproject up</code> work in a mathlib directory? That's not clear to me from the output of <code>--help</code></p>

<a name="189000957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189000957" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189000957">Patrick Massot (Feb 25 2020 at 08:48)</a>:</h4>
<p>I thought I changed the url, but something went wrong. This should work now</p>

<a name="189000991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189000991" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189000991">Patrick Massot (Feb 25 2020 at 08:49)</a>:</h4>
<p>About upgrade, how would you phrase the help message to make it clear it will work everywhere?</p>

<a name="189001690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189001690" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189001690">Johan Commelin (Feb 25 2020 at 09:02)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> What is the difference with <code>up</code>?</p>

<a name="189001700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189001700" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189001700">Johan Commelin (Feb 25 2020 at 09:02)</a>:</h4>
<p>I mean <code>get-cache</code> vs <code>up</code>.</p>

<a name="189001711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189001711" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189001711">Patrick Massot (Feb 25 2020 at 09:02)</a>:</h4>
<p>In mathlib itself, <code>up</code> will try to <code>git pull</code> then get oleans</p>

<a name="189001719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189001719" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189001719">Johan Commelin (Feb 25 2020 at 09:02)</a>:</h4>
<p>Aha, I see.</p>

<a name="189001733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189001733" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189001733">Patrick Massot (Feb 25 2020 at 09:03)</a>:</h4>
<p>In a project depending on mathlib, up will do what <code>leanpkg upgrade</code>+<code>leanpkg configure</code>+<code>update-mathlib</code> did</p>

<a name="189001741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189001741" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189001741">Patrick Massot (Feb 25 2020 at 09:03)</a>:</h4>
<p>without the occasional "is not a tree" weird error message.</p>

<a name="189001749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189001749" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189001749">Johan Commelin (Feb 25 2020 at 09:03)</a>:</h4>
<p>Ok, that seems useful.</p>

<a name="189001841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189001841" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189001841">Johan Commelin (Feb 25 2020 at 09:05)</a>:</h4>
<p>Is there a place where you want to document this, besides <code>--help</code>? Because this seems hard to summarise in one line.</p>

<a name="189001848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189001848" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189001848">Johan Commelin (Feb 25 2020 at 09:05)</a>:</h4>
<p>Or is <code>--help</code> also for longer explanations?</p>

<a name="189001926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189001926" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189001926">Patrick Massot (Feb 25 2020 at 09:06)</a>:</h4>
<p>Of course there will be longer help in a new version of <a href="https://github.com/leanprover-community/mathlib/blob/master/docs/install/project.md" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/master/docs/install/project.md">https://github.com/leanprover-community/mathlib/blob/master/docs/install/project.md</a></p>

<a name="189001938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189001938" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189001938">Patrick Massot (Feb 25 2020 at 09:06)</a>:</h4>
<p>But <code>leanproject up --help</code> will also display more</p>

<a name="189002060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189002060" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189002060">Johan Commelin (Feb 25 2020 at 09:08)</a>:</h4>
<p>Aah, <span class="user-mention" data-user-id="110031">@Patrick Massot</span> I think it makes sense to show in the general <code>--help</code> that <code>CMD --help</code> will show more details.</p>

<a name="189002193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189002193" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189002193">Patrick Massot (Feb 25 2020 at 09:10)</a>:</h4>
<p>I don't know if we can do that in the current setup, I'll investigate. Yesterday I switched from <a href="https://google.github.io/python-fire/" target="_blank" title="https://google.github.io/python-fire/">fire</a> to <a href="https://click.palletsprojects.com/en/7.x/" target="_blank" title="https://click.palletsprojects.com/en/7.x/">click</a> for command line handling and help building (because it seemed easier to create aliases).</p>

<a name="189004098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/new%20mathlib%20tools/near/189004098" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/62589newmathlibtools.html#189004098">Rob Lewis (Feb 25 2020 at 09:42)</a>:</h4>
<p>Indeed, I think the output of <code>leanproject --help</code> could be expanded a bit. <code>upgrade-mathlib</code> in particular isn't clear. Maybe "Upgrade a mathlib dependency to the latest compatible version" or something like that?</p>


{% endraw %}

{% include archive_update.html %}