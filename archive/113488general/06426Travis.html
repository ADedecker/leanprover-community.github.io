---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/06426Travis.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html">Travis</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="175361313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175361313" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175361313">Floris van Doorn (Sep 10 2019 at 17:49)</a>:</h4>
<p>Travis is timing out on completely innocent pull requests, like <a href="https://github.com/leanprover-community/mathlib/issues/1423" target="_blank" title="https://github.com/leanprover-community/mathlib/issues/1423">#1423</a>. <br>
Does anyone know which commit caused this regressed behavior?</p>
<p>I saw that other Github repo's automatically got a reply with compilation performance. Maybe we can make a bot that automatically replies to a PR if the compilation time is increased by more than 5% or something?</p>

<a name="175361861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175361861" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175361861">Floris van Doorn (Sep 10 2019 at 17:55)</a>:</h4>
<p>I assumed in my previous message that there was a merged commit that caused performance issues, but they all seem fine. Maybe this was a cache-related issue (I merged the PR into master, maybe that fixes it)</p>

<a name="175363359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175363359" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175363359">Rob Lewis (Sep 10 2019 at 18:11)</a>:</h4>
<p>Regardless of what caused it here, regression testing for compilation time would be a good idea.</p>

<a name="175363403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175363403" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175363403">Rob Lewis (Sep 10 2019 at 18:11)</a>:</h4>
<p>I don't know if Travis is reliable enough to do this.</p>

<a name="175363427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175363427" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175363427">Rob Lewis (Sep 10 2019 at 18:11)</a>:</h4>
<p>But maybe we could run something once a day on Scott's server?</p>

<a name="175363495"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175363495" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175363495">Rob Lewis (Sep 10 2019 at 18:12)</a>:</h4>
<p>I guess that would more reliably throw the same processing power at it.</p>

<a name="175363544"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175363544" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175363544">Reid Barton (Sep 10 2019 at 18:12)</a>:</h4>
<p>Last three pushes to master built in around 107 (most recent), 100, 110 minutes. I didn't look at the changes, but I assume they were not responsible for this variance.</p>

<a name="175363759"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175363759" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175363759">Reid Barton (Sep 10 2019 at 18:14)</a>:</h4>
<p>Interestingly <a href="https://travis-ci.org/leanprover-community/mathlib/builds/583109848?utm_source=github_status&amp;utm_medium=notification" target="_blank" title="https://travis-ci.org/leanprover-community/mathlib/builds/583109848?utm_source=github_status&amp;utm_medium=notification">this build</a> of PR <a href="https://github.com/leanprover-community/mathlib/issues/1428" target="_blank" title="https://github.com/leanprover-community/mathlib/issues/1428">#1428</a> timed out, but <code>leanpkg build</code> actually finished, it just took so much longer than usual that there wasn't enough time left to run <code>leanchecker</code>.</p>

<a name="175364067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175364067" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175364067">Reid Barton (Sep 10 2019 at 18:17)</a>:</h4>
<p>I'm sure a dedicated machine would be more consistent, I'm not sure how much more consistent.<br>
Doesn't Scott already build everything anyways? Or did I imagine that?</p>

<a name="175364221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175364221" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175364221">Rob Lewis (Sep 10 2019 at 18:19)</a>:</h4>
<p>I think the mathlib nightlies get pushed to Scott from Travis. Would he be building for another reason?</p>

<a name="175364308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175364308" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175364308">Rob Lewis (Sep 10 2019 at 18:20)</a>:</h4>
<p>I could be wrong about that though.</p>

<a name="175380528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175380528" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175380528">Scott Morrison (Sep 10 2019 at 21:35)</a>:</h4>
<p>No, at present I'm still building nothing. That project fell through, for lack of anyone who had the time/expertise combination to script things. I <em>think</em> the idea had been to push from travis to my account on S3, and then for my computer to poll that S3 account, but the pushing-to-S3 step never happened.</p>

<a name="175380624"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175380624" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175380624">Scott Morrison (Sep 10 2019 at 21:36)</a>:</h4>
<p>I would love to have the infrastructure in place so that every commit received an olean cache. I can provide the CPU time, I think.</p>

<a name="175380791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175380791" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175380791">Rob Lewis (Sep 10 2019 at 21:38)</a>:</h4>
<p>I think that's <span class="user-mention" data-user-id="110026">@Simon Hudon</span> 's territory. Checking build times once a day would be a lot simpler. Do you think your server has a consistent enough load to do this with enough precision?</p>

<a name="175381239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175381239" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175381239">Scott Morrison (Sep 10 2019 at 21:45)</a>:</h4>
<p>Probably. It has 18 physical cores. I routinely leave some single-threaded calculations running, but it's never more than 6. It's been a while since I've had anything multithreaded that I want left running. So if I limit the build to say 6 or 8 cores, and run it in the middle of my night, it shouldn't have any competition.</p>

<a name="175381306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175381306" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175381306">Scott Morrison (Sep 10 2019 at 21:46)</a>:</h4>
<p>The idea is that I would just pull a fresh copy of master, build, and have a script post the time here?</p>

<a name="175381416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175381416" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175381416">Rob Lewis (Sep 10 2019 at 21:48)</a>:</h4>
<p>Yeah, something like that. We just want to see an alert if there's an unexpected jump in compile time. Posting here would be enough.</p>

<a name="175381554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175381554" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175381554">Rob Lewis (Sep 10 2019 at 21:50)</a>:</h4>
<p>Ideally, if it noticed a spike it would try to find the responsible commit.</p>

<a name="175381574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175381574" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175381574">Rob Lewis (Sep 10 2019 at 21:50)</a>:</h4>
<p>That could use a bunch more cycles.</p>

<a name="175381962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175381962" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175381962">Scott Morrison (Sep 10 2019 at 21:52)</a>:</h4>
<p>I think our limiting factor is scripting and testing, not available cycles.</p>

<a name="175382070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175382070" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175382070">Scott Morrison (Sep 10 2019 at 21:54)</a>:</h4>
<p>I am just capable enough at writing bash scripts to do a bad job of this, so help would definitely be appreciated. It might require jumping through some hoops, but I could probably work out how to give someone ssh access.</p>

<a name="175402790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Travis/near/175402790" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/06426Travis.html#175402790">Simon Hudon (Sep 11 2019 at 05:36)</a>:</h4>
<p>Feel free to put that code up on <code>mathlib-tools</code> and I'll see if I can contribute something</p>


{% endraw %}

{% include archive_update.html %}