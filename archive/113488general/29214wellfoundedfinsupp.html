---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/29214wellfoundedfinsupp.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html">well_founded finsupp</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="170701513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170701513" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170701513">Johan Commelin (Jul 12 2019 at 07:37)</a>:</h4>
<p>Can someone explain to me how to prove that</p>
<div class="codehilite"><pre><span></span><span class="kn">instance</span> <span class="o">[</span><span class="n">preorder</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">preorder</span> <span class="o">(</span><span class="n">σ</span> <span class="bp">→</span><span class="err">₀</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">le</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">s</span> <span class="bp">≤</span> <span class="n">g</span> <span class="n">s</span><span class="o">,</span>
  <span class="n">le_refl</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">f</span> <span class="n">s</span><span class="o">,</span> <span class="n">le_refl</span> <span class="bp">_</span><span class="o">,</span>
  <span class="n">le_trans</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">f</span> <span class="n">g</span> <span class="n">h</span> <span class="n">Hfg</span> <span class="n">Hgh</span> <span class="n">s</span><span class="o">,</span> <span class="n">le_trans</span> <span class="o">(</span><span class="n">Hfg</span> <span class="n">s</span><span class="o">)</span> <span class="o">(</span><span class="n">Hgh</span> <span class="n">s</span><span class="o">)</span> <span class="o">}</span>
</pre></div>


<p>(see <a href="https://github.com/leanprover-community/mathlib/pull/1216/files#diff-af9f424915b54a36301c2cba4d92a12cR1447" target="_blank" title="https://github.com/leanprover-community/mathlib/pull/1216/files#diff-af9f424915b54a36301c2cba4d92a12cR1447">https://github.com/leanprover-community/mathlib/pull/1216/files#diff-af9f424915b54a36301c2cba4d92a12cR1447</a>)<br>
is well founded in the case <code>α := ℕ</code></p>

<a name="170701561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170701561" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170701561">Chris Hughes (Jul 12 2019 at 07:38)</a>:</h4>
<p><code>measure_wf</code></p>

<a name="170701580"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170701580" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170701580">Chris Hughes (Jul 12 2019 at 07:39)</a>:</h4>
<p>But you have to show that <code>lt = λ f g, ∀ s, f s &lt; g s</code></p>

<a name="170701586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170701586" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170701586">Chris Hughes (Jul 12 2019 at 07:39)</a>:</h4>
<p>And that isn't your definition, but maybe it should be.</p>

<a name="170701742"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170701742" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170701742">Kenny Lau (Jul 12 2019 at 07:42)</a>:</h4>
<p>but it isn't</p>

<a name="170701760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170701760" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170701760">Johan Commelin (Jul 12 2019 at 07:42)</a>:</h4>
<p>No, that's not the definition I want</p>

<a name="170701859"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170701859" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170701859">Chris Hughes (Jul 12 2019 at 07:44)</a>:</h4>
<p>Ah, it's actually much harder than I thought.</p>

<a name="170701885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170701885" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170701885">Kenny Lau (Jul 12 2019 at 07:45)</a>:</h4>
<p>show that the downset is finite</p>

<a name="170701897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170701897" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170701897">Johan Commelin (Jul 12 2019 at 07:45)</a>:</h4>
<p>Right, you did that.</p>

<a name="170701908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170701908" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170701908">Johan Commelin (Jul 12 2019 at 07:45)</a>:</h4>
<p>How do I turn that into a proof of <code>wf</code>?</p>

<a name="170701967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170701967" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170701967">Kenny Lau (Jul 12 2019 at 07:46)</a>:</h4>
<p>I don't know</p>

<a name="170701973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170701973" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170701973">Kenny Lau (Jul 12 2019 at 07:46)</a>:</h4>
<p>but that seems like an important lemma</p>

<a name="170701994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170701994" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170701994">Johan Commelin (Jul 12 2019 at 07:47)</a>:</h4>
<p>I only ask you to prove important lemmas <span aria-label="stuck out tongue wink" class="emoji emoji-1f61c" role="img" title="stuck out tongue wink">:stuck_out_tongue_wink:</span></p>

<a name="170702124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170702124" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170702124">Chris Hughes (Jul 12 2019 at 07:49)</a>:</h4>
<p>This is provable right.</p>
<div class="codehilite"><pre><span></span><span class="n">f</span> <span class="bp">&lt;</span> <span class="n">g</span> <span class="bp">→</span> <span class="n">f</span><span class="bp">.</span><span class="n">sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="bp">_</span><span class="o">,</span> <span class="n">id</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="n">g</span><span class="bp">.</span><span class="n">sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="bp">_</span><span class="o">,</span> <span class="n">id</span><span class="o">)</span>
</pre></div>

<a name="170702211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170702211" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170702211">Kenny Lau (Jul 12 2019 at 07:51)</a>:</h4>
<p>I think it is</p>

<a name="170702969"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170702969" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170702969">Johan Commelin (Jul 12 2019 at 08:05)</a>:</h4>
<p>I now have an order embedding into multiset. How do I pullback the wellfoundedness?</p>

<a name="170703001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170703001" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170703001">Kenny Lau (Jul 12 2019 at 08:05)</a>:</h4>
<p>subrel of wf is wf; inv_image of wf is wf</p>

<a name="170703004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170703004" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170703004">Johan Commelin (Jul 12 2019 at 08:05)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">to_multiset_strict_mono</span> <span class="o">:</span> <span class="n">strict_mono</span> <span class="o">(</span><span class="bp">@</span><span class="n">to_multiset</span> <span class="n">σ</span> <span class="bp">_</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">m</span> <span class="n">n</span> <span class="n">h</span><span class="o">,</span>
<span class="k">begin</span>
  <span class="n">rw</span> <span class="n">lt_iff_le_and_ne</span> <span class="n">at</span> <span class="n">h</span> <span class="err">⊢</span><span class="o">,</span> <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">h₁</span> <span class="n">h₂</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">multiset</span><span class="bp">.</span><span class="n">le_iff_count</span><span class="o">,</span> <span class="n">intro</span> <span class="n">s</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">count_to_multiset</span><span class="o">,</span> <span class="n">count_to_multiset</span><span class="o">],</span> <span class="n">exact</span> <span class="n">h₁</span> <span class="n">s</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">H</span><span class="o">,</span> <span class="n">apply</span> <span class="n">h₂</span><span class="o">,</span> <span class="n">replace</span> <span class="n">H</span> <span class="o">:=</span> <span class="n">congr_arg</span> <span class="n">multiset</span><span class="bp">.</span><span class="n">to_finsupp</span> <span class="n">H</span><span class="o">,</span> <span class="n">simpa</span> <span class="kn">using</span> <span class="n">H</span> <span class="o">}</span>
<span class="kn">end</span>
</pre></div>

<a name="170703067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170703067" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170703067">Chris Hughes (Jul 12 2019 at 08:06)</a>:</h4>
<p><code>inv_image.wf</code></p>

<a name="170703812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170703812" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170703812">Johan Commelin (Jul 12 2019 at 08:21)</a>:</h4>
<p>Aah, but the well founded relation on multiset is not the subset relation, is it?</p>

<a name="170703923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170703923" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170703923">Chris Hughes (Jul 12 2019 at 08:22)</a>:</h4>
<p>It's strict subset.</p>

<a name="170703946"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170703946" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170703946">Chris Hughes (Jul 12 2019 at 08:23)</a>:</h4>
<p>Both ssubset and <code>lt</code> are well founded.</p>

<a name="170703954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170703954" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170703954">Johan Commelin (Jul 12 2019 at 08:23)</a>:</h4>
<p>Is there a proof that <code>lt</code> is well founded?</p>

<a name="170703958"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170703958" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170703958">Johan Commelin (Jul 12 2019 at 08:23)</a>:</h4>
<p>Because that is the one I want to pull back</p>

<a name="170703965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170703965" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170703965">Johan Commelin (Jul 12 2019 at 08:23)</a>:</h4>
<p>But typeclass inference finds the other one</p>

<a name="170704014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170704014" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170704014">Chris Hughes (Jul 12 2019 at 08:24)</a>:</h4>
<p>There's probably a proof it implies card &lt; card</p>

<a name="170705862"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/well_founded%20finsupp/near/170705862" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/29214wellfoundedfinsupp.html#170705862">Kevin Buzzard (Jul 12 2019 at 08:55)</a>:</h4>
<p>I love the way that we mathematicians still don't properly understand the only induction we ever (explicitly) use.</p>


{% endraw %}

{% include archive_update.html %}