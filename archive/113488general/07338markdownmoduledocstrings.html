---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/07338markdownmoduledocstrings.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html">markdown module docstrings</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="179874075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179874075" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179874075">Chris Hughes (Nov 04 2019 at 20:41)</a>:</h4>
<p>Noob question. </p>
<p>Since we're writing all these docstrings at the top of <code>.lean</code> files in mathlib in markdown, presumably there's an easy way to see the markdown? What does <code>/-! -/</code> do?</p>

<a name="179874450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179874450" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179874450">Rob Lewis (Nov 04 2019 at 20:45)</a>:</h4>
<p>Nothing useful with Lean 3.4.2 -- I think there's something missing from the API that's either fixed or fixable in the community fork. They're docstrings associated with the file instead of a particular declaration, and metaprograms can in principle access them.</p>

<a name="179874510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179874510" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179874510">Rob Lewis (Nov 04 2019 at 20:46)</a>:</h4>
<p>IIRC in 3.4.2 you can only get the docstring for the current file.</p>

<a name="179874558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179874558" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179874558">Rob Lewis (Nov 04 2019 at 20:46)</a>:</h4>
<p>It's more of a future-proofing thing. At some point we'll want to generate HTML docs for the library, and having the comments already in markdown will be convenient then.</p>

<a name="179874689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179874689" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179874689">Rob Lewis (Nov 04 2019 at 20:48)</a>:</h4>
<p>It might actually be a useful VSCode plugin to format and display the module doc for the current file when you press a button.</p>

<a name="179909843"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179909843" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179909843">matt rice (Nov 05 2019 at 08:10)</a>:</h4>
<p>You can see lean 3.4.2's tests <a href="https://github.com/leanprover/lean/blob/ceacfa7445953cbc8860ddabc55407430a9ca5c3/tests/lean/run/doc_string3.lean" target="_blank" title="https://github.com/leanprover/lean/blob/ceacfa7445953cbc8860ddabc55407430a9ca5c3/tests/lean/run/doc_string3.lean">doc_string3.lean</a> for the extent of the non-community edition support e.g. there are some tactics for printing out the doc_strings.</p>
<p>I haven't tested if lumpy-leandoc does the right thing for <code>/-! -/</code> yet... but it'd be very easy to add something which extracts the .md file to it in addition to the limited html/pdf stuff it currently does.</p>

<a name="179972494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179972494" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179972494">matt rice (Nov 05 2019 at 20:18)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span>  I fixed up lumpy so it could build mathlib again, <a href="https://gist.github.com/ratmice/00072c2695d335dfade2db54f18ae333#file-mathlib-docs-zip" target="_blank" title="https://gist.github.com/ratmice/00072c2695d335dfade2db54f18ae333#file-mathlib-docs-zip">mathlib-docs.zip</a></p>
<p>Rob Lewis seems correct in that it's not useful with 3.4.2 in lumpy at least, the <code>/-! -/</code> comments never make it to the output, so <code>/-! -/</code> only shows up when the lean files were built with the community edition.</p>
<p>The way lumpy treats <code>/-! -/</code> is to include it verbatim, i.e. It doesn't prepend it with the name of the definition to which the doc_string is associated, because it's generally just associated with the section that corresponds to the file.<br>
Hopefully that helps.</p>

<a name="179973162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179973162" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179973162">Rob Lewis (Nov 05 2019 at 20:25)</a>:</h4>
<p>That's actually closer to real doc generation than I realized we were.</p>

<a name="179973228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179973228" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179973228">Rob Lewis (Nov 05 2019 at 20:26)</a>:</h4>
<p>It seems to be treating the sections of module docs as sections of the document, which is very confusing.</p>

<a name="179973242"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179973242" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179973242">Rob Lewis (Nov 05 2019 at 20:26)</a>:</h4>
<p>But the core structure is there.</p>

<a name="179973394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179973394" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179973394">Rob Lewis (Nov 05 2019 at 20:28)</a>:</h4>
<blockquote>
<p>It seems to be treating the sections of module docs as sections of the document, which is very confusing.</p>
</blockquote>
<p>In the PDF, that is. The HTML looks better, except it doesn't print the def names? Which do appear in the PDF?</p>

<a name="179973423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179973423" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179973423">matt rice (Nov 05 2019 at 20:28)</a>:</h4>
<p>Yeah, it's because I was following the html -&gt; tex convention that e.g. &lt;h1&gt; corresponds to \chapter &lt;h2&gt; \section etc, and the docs aren't really built with that in mind</p>

<a name="179973712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179973712" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179973712">Rob Lewis (Nov 05 2019 at 20:29)</a>:</h4>
<p>Yeah, this was the forseeable problem with creating the doc standards before we could generate docs.</p>

<a name="179973891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179973891" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179973891">matt rice (Nov 05 2019 at 20:31)</a>:</h4>
<p>Yup, I haven't done a lot of work on the html generation (or in fact looked at it today), it should in theory be easy to add unless i have forgotten why it is missing, I will try and look at it again tomorrow and fix that if I can.</p>

<a name="179974669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179974669" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179974669">Rob Lewis (Nov 05 2019 at 20:37)</a>:</h4>
<p>Cool. What are the prospects for linking? Something like this: "if an identifier appears between backticks, and we've seen a declaration with that name, turn it into a link." I'm guessing that's way more work?</p>

<a name="179975772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179975772" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179975772">matt rice (Nov 05 2019 at 20:48)</a>:</h4>
<p>Something like that, It'll need some thought, as it parses all lean files in parallel currently, so i'll probably have to do a pass over declarations build a table of declarations first before generating links (I'm guessing we want to link across files, which means we also need to mirror the import behavior I suppose)... <span aria-label="octopus" class="emoji emoji-1f419" role="img" title="octopus">:octopus:</span></p>

<a name="179976376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179976376" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179976376">Rob Lewis (Nov 05 2019 at 20:54)</a>:</h4>
<p>With two passes I think you could ignore the import tree. Generate a table the first pass, and note which html file each declaration will live in. Then fill in the info in the second pass. Namespacing means this will be impossible to get exactly right though. There's no way doc strings will be consistent about referring to declarations with full namespaces, and there will be ambiguous cases.</p>

<a name="179976846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179976846" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179976846">matt rice (Nov 05 2019 at 20:58)</a>:</h4>
<p>yeah, shall see if we can get away with that, anyhow i must get going.</p>

<a name="179977349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179977349" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#179977349">Rob Lewis (Nov 05 2019 at 21:02)</a>:</h4>
<p>Thanks for looking into this! It would be great to generate HTML docs for the website and this isn't so far off.</p>

<a name="180013747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180013747" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#180013747">matt rice (Nov 06 2019 at 09:10)</a>:</h4>
<p>Well, i updated it (and the zip file) to add the names of declarations, and a horizontal rule separating the header.</p>
<p>I think i will look at making TeX rendering optional, because the output isn't ready for consumption and it makes integrating into CI difficult since it needs lots of font stuff compiled in a specific way... With that it'll hopefully be easier to integrate into the website...</p>

<a name="180015725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180015725" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#180015725">Rob Lewis (Nov 06 2019 at 09:41)</a>:</h4>
<p>Nice! I just checked out a couple of the better documented files. It looks great. <a href="https://leanprover-community.github.io/doc_demo/manifold.html" target="_blank" title="https://leanprover-community.github.io/doc_demo/manifold.html">https://leanprover-community.github.io/doc_demo/manifold.html</a></p>

<a name="180015788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180015788" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#180015788">Rob Lewis (Nov 06 2019 at 09:42)</a>:</h4>
<p>What about printing the type of the declaration along with the name?</p>

<a name="180015988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180015988" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#180015988">Rob Lewis (Nov 06 2019 at 09:45)</a>:</h4>
<p>Right now it only prints declarations that have docstrings, right? Our doc guidelines don't require them for theorems, since in principle all you need to know about a theorem is its statement. Complicated/big/important theorems should have docstrings anyway, but we probably want more than just those in the doc output.</p>

<a name="180016062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180016062" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#180016062">Rob Lewis (Nov 06 2019 at 09:46)</a>:</h4>
<p>Is it overkill to print everything in the html docs? It feels to me like it should describe a "public" API, and there are plenty of things in the library that don't need to show up there. But I'm not sure.</p>

<a name="180016089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180016089" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#180016089">Johan Commelin (Nov 06 2019 at 09:47)</a>:</h4>
<p><span class="user-mention" data-user-id="143402">@matt rice</span> Wow, that looks really good</p>

<a name="180016121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180016121" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#180016121">Rob Lewis (Nov 06 2019 at 09:47)</a>:</h4>
<p>The <code>&lt;div&gt;</code>s containing the declarations should have a class so we can style it better, but that's easy.</p>

<a name="180016221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180016221" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#180016221">Rob Lewis (Nov 06 2019 at 09:48)</a>:</h4>
<p>Also we need index pages. Also easy, I hope :)</p>

<a name="180016492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180016492" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#180016492">Rob Lewis (Nov 06 2019 at 09:53)</a>:</h4>
<p>Once this is up and running, it gives another argument for a mathlib release schedule. We could update the docs daily. But it would probably be clearer to have fixed versions.</p>

<a name="180016758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180016758" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/07338markdownmoduledocstrings.html#180016758">matt rice (Nov 06 2019 at 09:57)</a>:</h4>
<p>I will look at printing the type declaration, it's been on my list of things to do, but I have been scared that it's just going to give me the thing that the type is definitionally equal to, since i'm pulling it out of the bytecode :D</p>
<p>I don't know anything about html really, i'll try and figure out the div's class, I assume i need to declare some empty style e.g. decl and then give it the class decl?</p>
<p>I also wish I could style the syntax highlighting rather than hard coded colors, but that is going to take some work.</p>


{% endraw %}

{% include archive_update.html %}