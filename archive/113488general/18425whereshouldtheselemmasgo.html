---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113488general/18425whereshouldtheselemmasgo.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/18425whereshouldtheselemmasgo.html">where should these lemmas go</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="171960930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/where%20should%20these%20lemmas%20go/near/171960930" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18425whereshouldtheselemmasgo.html#171960930">Kevin Kappelmann (Jul 29 2019 at 16:27)</a>:</h4>
<p>Can someone please advise me where the following lemmas should live in mathlib and if the naming/tagging is correct (proofs omitted):</p>
<div class="codehilite"><pre><span></span><span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span>
<span class="kn">lemma</span> <span class="n">rat</span><span class="bp">.</span><span class="n">div_num_denom_eq_div_nat_int</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">d</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">rat</span><span class="bp">.</span><span class="n">mk</span> <span class="n">n</span> <span class="n">d</span><span class="o">)</span><span class="bp">.</span><span class="n">num</span> <span class="bp">/</span> <span class="o">(</span><span class="n">rat</span><span class="bp">.</span><span class="n">mk</span> <span class="n">n</span> <span class="n">d</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">/</span> <span class="n">d</span> <span class="o">:=</span> <span class="n">sorry</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span>
<span class="kn">lemma</span> <span class="n">rat</span><span class="bp">.</span><span class="n">floor_eq_num_div_denom</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">d</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="err">⌊</span><span class="n">rat</span><span class="bp">.</span><span class="n">mk</span> <span class="n">n</span> <span class="n">d</span><span class="err">⌋</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">/</span> <span class="n">d</span> <span class="o">:=</span> <span class="n">sorry</span>

<span class="kn">lemma</span> <span class="n">mod_eq_sub_mul_floor_rat</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">d</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">n</span> <span class="err">%</span> <span class="n">d</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">d</span> <span class="bp">*</span> <span class="err">⌊</span><span class="n">rat</span><span class="bp">.</span><span class="n">mk</span> <span class="n">n</span> <span class="n">d</span><span class="err">⌋</span> <span class="o">:=</span> <span class="n">sorry</span>

<span class="kn">lemma</span> <span class="n">coprime_sub_mul_floor</span> <span class="o">{</span><span class="n">n</span> <span class="n">d</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">n_coprime_d</span> <span class="o">:</span> <span class="n">n</span><span class="bp">.</span><span class="n">coprime</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">((</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="bp">-</span> <span class="n">d</span> <span class="bp">*</span> <span class="err">⌊</span><span class="n">rat</span><span class="bp">.</span><span class="n">mk</span> <span class="n">n</span> <span class="n">d</span><span class="err">⌋</span><span class="o">)</span><span class="bp">.</span><span class="n">nat_abs</span><span class="bp">.</span><span class="n">coprime</span> <span class="n">d</span> <span class="o">:=</span> <span class="n">sorry</span>
</pre></div>


<p>Thank you :)</p>

<a name="171965537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/where%20should%20these%20lemmas%20go/near/171965537" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18425whereshouldtheselemmasgo.html#171965537">Kevin Buzzard (Jul 29 2019 at 17:23)</a>:</h4>
<p>So let me say first that I have had very little experience of PR'ing to mathlib and you will want to get some more experienced voices before doing anything. But here's my two cents:</p>
<p>I would instinctively say "put stuff like this in <code>data.rat.basic</code>" but that file is already over 1000 lines long. Maybe it's time to split it into more than one file? We have the directory data/rat now. </p>
<p>Actually, looking at it a bit closer, maybe it should be reformulated a bit. My instinct is that one should prove <code>⌊ q ⌋ = q.num / q.denom</code> (which seems like a cleaner statement, there are no n's and d's involved, and <code>library_search</code> doesn't seem to find this) and then the first lemma follows from this and the second lemma, which makes me wonder whether the first lemma is needed at all. I'm wondering whether it's best to include just the second lemma and this <code>⌊ q ⌋ = q.num / q.denom</code> statement because they are both quite succinct, and I could imagine that they could both go in data.rat.basic or data.rat.basic2 if it gets split.</p>
<p>The third lemma is an easy consequence of the second lemma and <code>int.mod_add_div</code> I guess, so my instinct is that the natural results are there and the user can put them together if they want the 3rd result. Similarly the 4th result is not really a result about rationals, if you use the second statement then it becomes an assertion about integers which could go in data.int.gcd or something, if it's not already there.</p>
<p>PS while writing this answer I discovered that <code>data.int.basic</code> imports <code>algebra.field</code>. Not what I would have guessed.</p>

<a name="171965846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/where%20should%20these%20lemmas%20go/near/171965846" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18425whereshouldtheselemmasgo.html#171965846">Kevin Buzzard (Jul 29 2019 at 17:27)</a>:</h4>
<p>Hmm, I see that I suggested that some lemmas involving floors could go in data.rat.basic but that's no good because the floor stuff is defined in algebra/archimedean.lean which imports data.rat.basic. So the floor rational stuff would have go to in there I guess.</p>

<a name="171979719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/where%20should%20these%20lemmas%20go/near/171979719" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18425whereshouldtheselemmasgo.html#171979719">Kevin Kappelmann (Jul 29 2019 at 20:16)</a>:</h4>
<p>Alright, thanks for the pointers. I'll pick my best guess from the mentioned folders then and be prepared for some PR discussion :p </p>
<p><code>rat.floor</code> is actually defined as <code>q.num / q.denom</code>, so that's pretty simple:</p>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">{</span><span class="n">q</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">}</span> <span class="o">:</span> <span class="err">⌊</span><span class="n">q</span><span class="err">⌋</span> <span class="bp">=</span> <span class="n">q</span><span class="bp">.</span><span class="n">num</span> <span class="bp">/</span> <span class="n">q</span><span class="bp">.</span><span class="n">denom</span> <span class="o">:=</span> <span class="k">by</span> <span class="o">{</span> <span class="n">cases</span> <span class="n">q</span><span class="o">,</span> <span class="n">refl</span> <span class="o">}</span>
</pre></div>


<p>however, it does not hold that <code>(rat.mk n d).num = n</code> (and similar for <code>.denom</code>) since <code>rat.mk</code> has to create a coprime pair <code>(num : int , denom : nat)</code>. But it still holds that <code>(rat.mk n d).num / (rat.mk n d).denom = n / d</code>, which is my first lemma.</p>

<a name="171990931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/where%20should%20these%20lemmas%20go/near/171990931" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18425whereshouldtheselemmasgo.html#171990931">Mario Carneiro (Jul 29 2019 at 22:56)</a>:</h4>
<p>You can still simplify the first lemma using Kevin's lemma, to <code>⌊rat.mk n d⌋ = n / d</code></p>

<a name="171991016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/where%20should%20these%20lemmas%20go/near/171991016" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18425whereshouldtheselemmasgo.html#171991016">Mario Carneiro (Jul 29 2019 at 22:58)</a>:</h4>
<p>which makes it the same as the second lemma, hence why Kevin says it's not necessary</p>

<a name="171991040"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/where%20should%20these%20lemmas%20go/near/171991040" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18425whereshouldtheselemmasgo.html#171991040">Mario Carneiro (Jul 29 2019 at 22:59)</a>:</h4>
<p>You should swap the order to <code>q.num / q.denom = ⌊q⌋</code> if you want these to be simp lemmas though</p>

<a name="172017375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/where%20should%20these%20lemmas%20go/near/172017375" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/18425whereshouldtheselemmasgo.html#172017375">Kevin Kappelmann (Jul 30 2019 at 08:41)</a>:</h4>
<blockquote>
<p>You should swap the order to <code>q.num / q.denom = ⌊q⌋</code> if you want these to be simp lemmas though</p>
</blockquote>
<p>Should <code>⌊rat.mk n d⌋ = n / d</code> or <code>n / d = ⌊rat.mk n d⌋</code> or neither be a simp lemma? I would have picked the first one since it seems easier for me to deal with the division rather than <code>rat.mk</code> combined with <code>floor</code></p>


{% endraw %}

{% include archive_update.html %}