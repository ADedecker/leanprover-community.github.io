---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/113488general/88356toomanysemicolons.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113488general/index.html">general</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html">too many semicolons</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">
{% raw %}
<a name="161818362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161818362" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161818362">Scott Morrison (Mar 27 2019 at 01:02)</a>:</h4>
<p>I appreciate the desire to be terse, but there are many places where I think we go too far. As an example from <code>linear_combination.lean</code> (I haven't look up who wrote this --- no fingers are being pointed!)</p>
<div class="codehilite"><pre><span></span>theorem restrict_dom_comp_subtype (s : set β) :
  (restrict_dom α s).comp (submodule.subtype _) = linear_map.id :=
by ext l; apply subtype.coe_ext.2; simp; ext a;
   by_cases a ∈ s; simp [h]; exact (mem_supported&#39;.1 l.2 _ h).symm
</pre></div>


<p>This proof broke when I was trying to clean something up. With the semicolons everywhere, it's much harder to debug than a simple <code>begin ... end</code> block.</p>

<a name="161818369"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161818369" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161818369">Scott Morrison (Mar 27 2019 at 01:02)</a>:</h4>
<p>Indeed, exactly one of those semicolons is actually serving its real purpose (running a tactic on multiple goals).</p>

<a name="161818373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161818373" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161818373">Scott Morrison (Mar 27 2019 at 01:02)</a>:</h4>
<p>I would have preferred writing this proof as</p>
<div class="codehilite"><pre><span></span>theorem restrict_dom_comp_subtype (s : set β) :
  (restrict_dom α s).comp (submodule.subtype _) = linear_map.id :=
begin
  ext l,
  apply subtype.coe_ext.2,
  simp,
  ext a,
  by_cases h : a ∈ s; simp [h],
  exact (mem_supported&#39;.1 l.2 _ h).symm
end
</pre></div>

<a name="161818405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161818405" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161818405">Scott Morrison (Mar 27 2019 at 01:03)</a>:</h4>
<p>Now you can both see the structure better (<code>simp [h]</code> is acting on both branchs of <code>by_cases</code> --- otherwise the proof is linear),</p>

<a name="161818412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161818412" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161818412">Scott Morrison (Mar 27 2019 at 01:03)</a>:</h4>
<p>and if something goes wrong you can inspect the intermediate states.</p>

<a name="161818469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161818469" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161818469">Scott Morrison (Mar 27 2019 at 01:04)</a>:</h4>
<p>I worry that proofs like this are being written in "semicolon style" solely to reduce the character count (and perhaps that feeling of accomplishment when you get a proof short enough to use <code>by</code> instead of <code>begin ... end</code>)</p>

<a name="161818479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161818479" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161818479">Scott Morrison (Mar 27 2019 at 01:05)</a>:</h4>
<p>What do people think? Could we perhaps add something to the style guide discouraging the use of <code>by A;B;C;...;X;Y;Z</code> for chains beyond some length?</p>

<a name="161820641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161820641" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161820641">Simon Hudon (Mar 27 2019 at 01:46)</a>:</h4>
<p>I'm wondering if <code>simp only</code> wouldn't have done more to make the proof adaptable.</p>

<a name="161832360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161832360" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161832360">Johannes Hölzl (Mar 27 2019 at 06:14)</a>:</h4>
<p>I'm in absolutely agree that we should of avoid <code>by A;B;C;...;X;Y;Z</code> as much as possible. With small exceptions like <code>by c; m</code> where <code>c</code> is something like <code>ext</code> or <code>cases</code>, a predictable method to destruct the goal into simpler forms, and <code>m</code> is <code>simp</code> or similar.</p>

<a name="161832370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161832370" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161832370">Johannes Hölzl (Mar 27 2019 at 06:14)</a>:</h4>
<p><code>simp only</code> might help when it breaks, but it doesn't help to make the proof understandable</p>

<a name="161833172"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161833172" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161833172">Scott Morrison (Mar 27 2019 at 06:32)</a>:</h4>
<p>That's perhaps a stronger argument than I would have made. There are _many_ examples in mathlib of <code>by X; Y</code> which have only been written as that instead of <code>begin X, Y end</code> for the sake of brevity. What do you think of these?</p>

<a name="161833780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161833780" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161833780">Johan Commelin (Mar 27 2019 at 06:49)</a>:</h4>
<p>I have been guilty of golfing proofs down in this way. I wouldn't mind changing the culture.</p>

<a name="161834103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161834103" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161834103">Johannes Hölzl (Mar 27 2019 at 06:57)</a>:</h4>
<p>I sometimes also do it for the sake of brevity, but when I look at it some times later, I dislike it. But two methods have usually the flavour of first apply cases, or add some kind of "marker" which is then pushed through the statement to solve it.</p>

<a name="161835649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161835649" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161835649">Kevin Buzzard (Mar 27 2019 at 07:35)</a>:</h4>
<p>What about <code>by {A, B, C}</code>?</p>

<a name="161835660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161835660" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161835660">Johan Commelin (Mar 27 2019 at 07:35)</a>:</h4>
<p>I think it's a lot better, but it isn't common style.</p>

<a name="161835715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161835715" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161835715">Kevin Buzzard (Mar 27 2019 at 07:36)</a>:</h4>
<p>I remember being quite surprised the first time I saw a semicolon bring used in this way when there was only one goal</p>

<a name="161835735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161835735" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161835735">Kevin Buzzard (Mar 27 2019 at 07:36)</a>:</h4>
<p>The bracket notation only adds about two characters to the proof</p>

<a name="161835740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161835740" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161835740">Kevin Buzzard (Mar 27 2019 at 07:37)</a>:</h4>
<p>And I also had trouble debugging a semicolon proof recently</p>

<a name="161837070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161837070" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161837070">Scott Morrison (Mar 27 2019 at 08:04)</a>:</h4>
<p>Okay -- perhaps I will write a PR to the style guide that goes as far as saying: "don't misuse semicolons: <code>X; Y</code> means that <code>X</code> produces multiple goals, and you want to apply <code>Y</code> to each of them"</p>

<a name="161837173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161837173" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161837173">Sebastien Gouezel (Mar 27 2019 at 08:06)</a>:</h4>
<p>If you just have one semicolon and the two expressions are short, I think it is also acceptable. For instance, <code>by ext; simp</code> looks all right to me.</p>

<a name="161837174"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161837174" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161837174">Kevin Buzzard (Mar 27 2019 at 08:06)</a>:</h4>
<p>I would definitely support that change. I would even be happy if people consistently wrote <code>by {ext, blah}</code> instead of <code>by ext; blah</code>.</p>

<a name="161837203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161837203" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161837203">Scott Morrison (Mar 27 2019 at 08:07)</a>:</h4>
<p>Maybe one day we will have a proof-linting tool that actually checks for multiple goals when <code>;</code> is used.</p>

<a name="161837278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161837278" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161837278">Mario Carneiro (Mar 27 2019 at 08:09)</a>:</h4>
<p>Okay, I'm on board as long as I can still keep the two line compression proof</p>

<a name="161837292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161837292" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161837292">Mario Carneiro (Mar 27 2019 at 08:09)</a>:</h4>
<p>so the example would become</p>
<div class="codehilite"><pre><span></span><span class="k">by</span> <span class="o">{</span> <span class="n">ext</span> <span class="n">l</span><span class="o">,</span> <span class="n">apply</span> <span class="n">subtype</span><span class="bp">.</span><span class="n">coe_ext</span><span class="bp">.</span><span class="mi">2</span><span class="o">,</span> <span class="n">simp</span><span class="o">,</span> <span class="n">ext</span> <span class="n">a</span><span class="o">,</span>
     <span class="n">by_cases</span> <span class="n">a</span> <span class="err">∈</span> <span class="n">s</span><span class="bp">;</span> <span class="n">simp</span> <span class="o">[</span><span class="n">h</span><span class="o">],</span> <span class="n">exact</span> <span class="o">(</span><span class="n">mem_supported&#39;</span><span class="bp">.</span><span class="mi">1</span> <span class="n">l</span><span class="bp">.</span><span class="mi">2</span> <span class="bp">_</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span> <span class="o">}</span>
</pre></div>

<a name="161837353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161837353" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161837353">Mario Carneiro (Mar 27 2019 at 08:10)</a>:</h4>
<p>and where the internal spaces can be omitted for a one liner like Kevin's style</p>

<a name="161837454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161837454" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161837454">Mario Carneiro (Mar 27 2019 at 08:12)</a>:</h4>
<p>Actually, I would go so far as to say that <code>by</code> should always be used for compression style proofs and <code>begin ... end</code> for multiline proofs</p>

<a name="161837503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161837503" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161837503">Mario Carneiro (Mar 27 2019 at 08:13)</a>:</h4>
<p>i.e. <code>by {tac1, tac2}</code> preferred over <code>begin tac1, tac2 end</code>, and</p>
<div class="codehilite"><pre><span></span>begin
  tac1,
  tac2,
  tac3...
end
</pre></div>


<p>is preferred over</p>
<div class="codehilite"><pre><span></span>by {
  tac1,
  tac2,
  tac3...
}
</pre></div>


<p>or some such thing</p>

<a name="161837668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161837668" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161837668">Mario Carneiro (Mar 27 2019 at 08:16)</a>:</h4>
<p>To clarify on the original example (of which I am the author): I am also against using long strings of <code>tac; tac; tac</code> but my cutoff is about two lines, so that kind of example is around the upper limit</p>

<a name="161838053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161838053" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161838053">Kevin Buzzard (Mar 27 2019 at 08:25)</a>:</h4>
<p>We all have different styles I guess.</p>

<a name="161839525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161839525" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161839525">Scott Morrison (Mar 27 2019 at 08:52)</a>:</h4>
<p>Okay, it sounds like there's a reasonable compromise.</p>

<a name="161839549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161839549" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161839549">Scott Morrison (Mar 27 2019 at 08:53)</a>:</h4>
<p>One complaint I have about semicolons is that VSCode rarely manages to show me the intermediate states, and I really rely on this for parsing proofs.</p>

<a name="161839688"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/too%20many%20semicolons/near/161839688" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113488general/88356toomanysemicolons.html#161839688">Patrick Massot (Mar 27 2019 at 08:55)</a>:</h4>
<p>I agree with Scott, but this remark obviously don't apply to <code>by ext ; simp</code> or <code>by unfold ... ; apply_instance</code></p>


{% endraw %}
