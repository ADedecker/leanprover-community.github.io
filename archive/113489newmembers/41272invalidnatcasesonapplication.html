---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113489newmembers/41272invalidnatcasesonapplication.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/41272invalidnatcasesonapplication.html">invalid nat.cases_on application</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="179237461"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/invalid%20nat.cases_on%20application/near/179237461" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/41272invalidnatcasesonapplication.html#179237461">Julian Gilbey (Oct 28 2019 at 14:47)</a>:</h4>
<p>Hi, I'm just getting my head around Lean 3, and working through the Logic and Proof book on the Lean github page.  I'm trying to prove that \le is a total order on the naturals, but my code gives an error which I'm struggling to make sense of.  Any help would be much appreciated!   The code is below.  (Yes, I know my coding style is very rudimentary, and I haven't yet learnt how to use rw effectively.  I'll get there!  Any pointers in that direction would be helpful, but in the meantime, what is this bizarre error?  It would be good to have a "minimal example", but I don't know how to trim this one down, I'm afraid.)</p>
<p>The error message reads:</p>
<div class="codehilite"><pre><span></span>error: invalid &#39;nat.cases_on&#39; application, elaborator has special support for this kind of application (it is handled as an &quot;eliminator&quot;), but expected type must not contain metavariables
  ?m_1
</pre></div>


<p>and here is my code:</p>
<div class="codehilite"><pre><span></span><span class="kn">open</span> <span class="n">nat</span>

<span class="c1">-- we define ≼ to mean less than or equal to, using the following definition</span>
<span class="c1">-- rather than the inductive definition lean uses; yes, they&#39;re equivalent,</span>
<span class="c1">-- but let&#39;s see how this one goes!</span>
<span class="n">def</span> <span class="n">leq</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">c</span> <span class="o">:</span> <span class="n">nat</span><span class="o">,</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">b</span>
<span class="kn">infix</span> <span class="bp">`</span> <span class="err">≼</span> <span class="bp">`</span><span class="o">:</span><span class="mi">50</span> <span class="o">:=</span> <span class="n">leq</span>

<span class="kn">theorem</span> <span class="n">ineq_totality</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">nat</span><span class="o">,</span> <span class="n">n</span> <span class="err">≼</span> <span class="n">m</span> <span class="bp">∨</span> <span class="n">m</span> <span class="err">≼</span> <span class="n">n</span> <span class="o">:=</span>
<span class="k">assume</span> <span class="n">m</span> <span class="n">n</span><span class="o">,</span>
<span class="n">nat</span><span class="bp">.</span><span class="n">rec_on</span> <span class="n">n</span>
  <span class="o">(</span><span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">+</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">m</span><span class="o">,</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">zero_add</span><span class="o">,</span>
   <span class="k">have</span> <span class="n">hi</span> <span class="o">:</span> <span class="mi">0</span> <span class="err">≼</span> <span class="n">m</span><span class="o">,</span> <span class="k">from</span> <span class="n">exists</span><span class="bp">.</span><span class="n">intro</span> <span class="n">m</span> <span class="n">h</span><span class="o">,</span>
   <span class="k">show</span> <span class="mi">0</span> <span class="err">≼</span> <span class="n">m</span> <span class="bp">∨</span> <span class="n">m</span> <span class="err">≼</span> <span class="mi">0</span><span class="o">,</span> <span class="k">from</span> <span class="n">or</span><span class="bp">.</span><span class="n">inl</span> <span class="n">hi</span><span class="o">)</span>
  <span class="o">(</span><span class="k">assume</span> <span class="n">n</span><span class="o">,</span>
   <span class="k">assume</span> <span class="n">ih</span> <span class="o">:</span> <span class="n">n</span> <span class="err">≼</span> <span class="n">m</span> <span class="bp">∨</span> <span class="n">m</span> <span class="err">≼</span> <span class="n">n</span><span class="o">,</span>
   <span class="n">or</span><span class="bp">.</span><span class="n">elim</span>
     <span class="o">(</span><span class="k">assume</span> <span class="n">h1</span> <span class="o">:</span> <span class="n">n</span> <span class="err">≼</span> <span class="n">m</span><span class="o">,</span>
      <span class="n">exists</span><span class="bp">.</span><span class="n">elim</span> <span class="n">h1</span> <span class="err">$</span>
        <span class="k">assume</span> <span class="n">c</span> <span class="o">(</span><span class="n">hc</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">+</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">m</span><span class="o">),</span>
        <span class="n">nat</span><span class="bp">.</span><span class="n">cases_on</span> <span class="n">c</span>
         <span class="o">(</span><span class="k">have</span> <span class="n">he</span> <span class="o">:</span> <span class="n">succ</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">succ</span> <span class="n">n</span><span class="o">,</span> <span class="k">by</span> <span class="k">calc</span>
              <span class="n">succ</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">succ</span><span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">0</span><span class="o">)</span>    <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">eq</span><span class="bp">.</span><span class="n">subst</span> <span class="o">(</span><span class="n">eq</span><span class="bp">.</span><span class="n">symm</span> <span class="n">hc</span><span class="o">)</span>
                 <span class="bp">...</span> <span class="bp">=</span> <span class="n">succ</span> <span class="n">n</span>         <span class="o">:</span> <span class="n">rfl</span><span class="o">,</span>
          <span class="k">have</span> <span class="n">hi</span> <span class="o">:</span> <span class="n">m</span> <span class="err">≼</span> <span class="n">succ</span> <span class="n">n</span><span class="o">,</span> <span class="k">from</span> <span class="n">exists</span><span class="bp">.</span><span class="n">intro</span> <span class="mi">1</span> <span class="n">he</span><span class="o">,</span>
          <span class="k">show</span> <span class="n">succ</span> <span class="n">n</span> <span class="err">≼</span> <span class="n">m</span> <span class="bp">∨</span> <span class="n">m</span> <span class="err">≼</span> <span class="n">succ</span> <span class="n">n</span><span class="o">,</span> <span class="k">from</span> <span class="n">or</span><span class="bp">.</span><span class="n">inr</span> <span class="n">hi</span><span class="o">)</span>
         <span class="o">(</span><span class="k">assume</span> <span class="n">c</span><span class="o">,</span>
          <span class="k">have</span> <span class="n">he</span> <span class="o">:</span> <span class="n">succ</span> <span class="n">n</span> <span class="bp">+</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">m</span><span class="o">,</span> <span class="k">by</span> <span class="k">calc</span>
              <span class="n">succ</span> <span class="n">n</span> <span class="bp">+</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">succ</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">c</span><span class="o">)</span>   <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">succ_add</span>
                     <span class="bp">...</span> <span class="bp">=</span> <span class="n">succ</span> <span class="o">(</span><span class="n">c</span> <span class="bp">+</span> <span class="n">n</span><span class="o">)</span>   <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">add_symm</span>
                     <span class="bp">...</span> <span class="bp">=</span> <span class="n">succ</span> <span class="n">c</span> <span class="bp">+</span> <span class="n">n</span>     <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">succ_add</span>
                     <span class="bp">...</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">+</span> <span class="n">succ</span> <span class="n">c</span>     <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">add_symm</span>
                     <span class="bp">...</span> <span class="bp">=</span> <span class="n">m</span>              <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">hc</span><span class="o">,</span>
          <span class="k">have</span> <span class="n">hi</span> <span class="o">:</span> <span class="n">succ</span> <span class="n">n</span> <span class="err">≼</span> <span class="n">m</span><span class="o">,</span> <span class="k">from</span> <span class="n">exists</span><span class="bp">.</span><span class="n">intro</span> <span class="n">c</span> <span class="n">he</span><span class="o">,</span>
          <span class="k">show</span> <span class="n">succ</span> <span class="n">n</span> <span class="err">≼</span> <span class="n">m</span> <span class="bp">∨</span> <span class="n">m</span> <span class="err">≼</span> <span class="n">succ</span> <span class="n">n</span><span class="o">,</span> <span class="k">from</span> <span class="n">or</span><span class="bp">.</span><span class="n">inl</span> <span class="n">hi</span><span class="o">))</span>
     <span class="o">(</span><span class="k">assume</span> <span class="n">h1</span> <span class="o">:</span> <span class="n">m</span> <span class="err">≼</span> <span class="n">n</span><span class="o">,</span>
      <span class="n">exists</span><span class="bp">.</span><span class="n">elim</span> <span class="n">h1</span> <span class="err">$</span>
        <span class="k">assume</span> <span class="n">c</span> <span class="o">(</span><span class="n">hc</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">+</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">n</span><span class="o">),</span>
        <span class="k">have</span> <span class="n">he</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">+</span> <span class="n">succ</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">succ</span> <span class="n">n</span><span class="o">,</span> <span class="k">by</span> <span class="k">calc</span>
            <span class="n">m</span> <span class="bp">+</span> <span class="n">succ</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">succ</span> <span class="o">(</span><span class="n">m</span> <span class="bp">+</span> <span class="n">c</span><span class="o">)</span>   <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">succ_add</span>
                   <span class="bp">...</span> <span class="bp">=</span> <span class="n">succ</span> <span class="n">n</span>         <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">h</span><span class="o">,</span>
        <span class="k">have</span> <span class="n">hi</span> <span class="o">:</span> <span class="n">m</span> <span class="err">≼</span> <span class="n">succ</span> <span class="n">n</span><span class="o">,</span> <span class="k">from</span> <span class="n">exists</span><span class="bp">.</span><span class="n">intro</span> <span class="n">c</span> <span class="n">he</span><span class="o">,</span>
        <span class="k">show</span> <span class="n">succ</span> <span class="n">n</span> <span class="err">≼</span> <span class="n">m</span> <span class="bp">∨</span> <span class="n">m</span> <span class="err">≼</span> <span class="n">succ</span> <span class="n">n</span><span class="o">,</span> <span class="k">from</span> <span class="n">or</span><span class="bp">.</span><span class="n">inr</span> <span class="n">hi</span><span class="o">))</span>
</pre></div>


<p>Many thanks!</p>


{% endraw %}

{% include archive_update.html %}