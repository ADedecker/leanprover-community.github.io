---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113489newmembers/72888howtousesimp.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/72888howtousesimp.html">how to use simp</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="179406132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20use%20simp/near/179406132" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/72888howtousesimp.html#179406132">Jason Gross (Oct 30 2019 at 06:30)</a>:</h4>
<p>I have</p>
<div class="codehilite"><pre><span></span><span class="c1">-- set_option pp.numerals false</span>
<span class="kn">example</span> <span class="o">:</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="bp">â„¤</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">succ</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">6</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">int</span><span class="bp">.</span><span class="n">mul</span><span class="o">,</span><span class="n">bit0</span><span class="o">,</span><span class="n">bit1</span><span class="o">,</span><span class="n">has_one</span><span class="bp">.</span><span class="n">one</span><span class="o">,</span><span class="n">int</span><span class="bp">.</span><span class="n">one</span><span class="o">,</span><span class="n">int</span><span class="bp">.</span><span class="n">add</span><span class="o">,</span><span class="n">nat</span><span class="bp">.</span><span class="n">add</span><span class="o">,</span><span class="n">has_add</span><span class="bp">.</span><span class="n">add</span><span class="o">,</span><span class="n">has_mul</span><span class="bp">.</span><span class="n">mul</span><span class="o">,</span><span class="n">int</span><span class="bp">.</span><span class="n">mul</span><span class="o">,</span><span class="n">coe</span><span class="o">,</span><span class="n">lift_t</span><span class="o">,</span><span class="n">has_lift_t</span><span class="bp">.</span><span class="n">lift</span><span class="o">,</span><span class="n">coe_t</span><span class="o">,</span><span class="n">has_coe_t</span><span class="bp">.</span><span class="n">coe</span><span class="o">,</span><span class="n">coe_b</span><span class="o">,</span><span class="n">has_coe</span><span class="bp">.</span><span class="n">coe</span><span class="o">]</span>
<span class="kn">end</span>
</pre></div>


<p>I want to simplify the goal until it is <code>6 = 6</code> or <code>nat.succ (nat.succ (nat.succ (nat.succ (nat.succ (nat.succ nat.zero)))) = nat.succ (nat.succ (nat.succ (nat.succ (nat.succ (nat.succ nat.zero))))</code>.  (I know that I can prove it by reflexivity, but I am using this as a test case for a more complicated goal involving arithmetic expressions that I need to simplify to numerals, where I don't know what the final result is going to be (or where there are too many different possibilities to list out).)  If I add either <code>nat.mul</code> or <code>has_zero.zero</code> to this list, then lean times out.  How do I finish this simplification?</p>

<a name="179406848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20use%20simp/near/179406848" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/72888howtousesimp.html#179406848">Jason Gross (Oct 30 2019 at 06:50)</a>:</h4>
<p>Also, how do I unfold <code>list.partition._match_1</code>?  <code>simp only [list.partition._match_1]</code> seems to just always fail with <code>simplify tactic failed to simplify</code></p>

<a name="179408556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20use%20simp/near/179408556" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/72888howtousesimp.html#179408556">Mario Carneiro (Oct 30 2019 at 07:34)</a>:</h4>
<p>Use <code>norm_num</code> for goals like this</p>

<a name="179408576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20use%20simp/near/179408576" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/72888howtousesimp.html#179408576">Mario Carneiro (Oct 30 2019 at 07:35)</a>:</h4>
<p><code>norm_num</code> does arithmetic with numerals; <code>simp</code> doesn't understand numerals and their normal forms</p>

<a name="179408671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20use%20simp/near/179408671" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/72888howtousesimp.html#179408671">Mario Carneiro (Oct 30 2019 at 07:37)</a>:</h4>
<p>Unfolding everything in sight is 99% of the time the wrong thing to do. Lemmas should exist to unfold one definition at a time, and theorems should not have to break through more than two layers of abstraction or so</p>

<a name="179408717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20use%20simp/near/179408717" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/72888howtousesimp.html#179408717">Mario Carneiro (Oct 30 2019 at 07:38)</a>:</h4>
<p>What is the more complex goal you are trying to solve? This looks like an XY problem to me</p>

<a name="179430648"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20use%20simp/near/179430648" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/72888howtousesimp.html#179430648">Kenny Lau (Oct 30 2019 at 13:25)</a>:</h4>
<p>can we write a meta-tactic that will use the correct tactic in each situation? :P</p>

<a name="179440591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20use%20simp/near/179440591" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/72888howtousesimp.html#179440591">Kevin Buzzard (Oct 30 2019 at 15:00)</a>:</h4>
<p>It's really hard for an outsider to know the correct tactic. You have some stupid question which involves multiplication by 2 on the naturals and everyone says" Oh, it's Presburger, use <code>omega</code>" or something -- and then you have some other question which involves multiplication too and <code>omega</code> doesn't work and then they say "oh that's not Presburger, but <code>ring</code> will do that one obviously and you say "but the naturals aren't a ring" and they say "yeah but it's shorter than <code>semiring</code>", and then there's another one but neither <code>omega</code> or <code>ring</code> work and it turns out you need <code>linarith</code>. The mathematician proof of all of these is "it's now obvious", and we have difficulty expressing this exasperation in the language of tactics because for you it's several different kinds of obvious.</p>

<a name="179443136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20use%20simp/near/179443136" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/72888howtousesimp.html#179443136">Reid Barton (Oct 30 2019 at 15:22)</a>:</h4>
<p><code>tidy</code> already basically works like this. We could easily make a differently-configured <code>tidy</code> that just tries <code>norm_num</code>, <code>linarith</code>, <code>ring</code>, <code>omega</code> and shows you what worked (which <code>tidy</code> already knows how to do).</p>

<a name="179452103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20use%20simp/near/179452103" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/72888howtousesimp.html#179452103">Scott Morrison (Oct 30 2019 at 16:48)</a>:</h4>
<p>This is a good idea. It's probably best to call a version of <code>ring</code> that doesn't attempt to rewrite if it fails to close the goal. It may be worth thinking a little about which of these tactics "fail fast", and perhaps improve this.</p>

<a name="179452181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20use%20simp/near/179452181" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/72888howtousesimp.html#179452181">Scott Morrison (Oct 30 2019 at 16:48)</a>:</h4>
<p>But doing this on top of <code>tidy</code> will just be a few lines.</p>

<a name="179452276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20use%20simp/near/179452276" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/72888howtousesimp.html#179452276">Scott Morrison (Oct 30 2019 at 16:49)</a>:</h4>
<p>(On a related note, I have written a few proofs recently leaving the line <code>suggest</code> at the bottom of my <code>begin ... end</code> block as I work, and it can be pretty awesome... "Oh, you're done! That goal too!")</p>


{% endraw %}

{% include archive_update.html %}