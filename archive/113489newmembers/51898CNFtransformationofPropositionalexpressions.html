---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113489newmembers/51898CNFtransformationofPropositionalexpressions.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/51898CNFtransformationofPropositionalexpressions.html">CNF transformation of Propositional expressions</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="174352770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/CNF%20transformation%20of%20Propositional%20expressions/near/174352770" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/51898CNFtransformationofPropositionalexpressions.html#174352770">Alexandre Rademaker (Aug 28 2019 at 11:25)</a>:</h4>
<p>In Lean 3, would it be possible to implement the CNF transformation of a propositional formula? How?</p>

<a name="174352861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/CNF%20transformation%20of%20Propositional%20expressions/near/174352861" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/51898CNFtransformationofPropositionalexpressions.html#174352861">Patrick Massot (Aug 28 2019 at 11:27)</a>:</h4>
<p>Isn't it part of what <code>finish</code> or <code>tauto</code> are doing?</p>

<a name="174352972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/CNF%20transformation%20of%20Propositional%20expressions/near/174352972" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/51898CNFtransformationofPropositionalexpressions.html#174352972">Alexandre Rademaker (Aug 28 2019 at 11:29)</a>:</h4>
<p>Not sure.  But I am teaching a logic course in Lean using Avigad book and I want to show the students the CNF transformation, I thought that would be nice to implement it in Lean</p>

<a name="174353042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/CNF%20transformation%20of%20Propositional%20expressions/near/174353042" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/51898CNFtransformationofPropositionalexpressions.html#174353042">Patrick Massot (Aug 28 2019 at 11:30)</a>:</h4>
<p>I have no idea what I'm talking about, but you can have a look at the code of those tactics</p>

<a name="174354062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/CNF%20transformation%20of%20Propositional%20expressions/near/174354062" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/51898CNFtransformationofPropositionalexpressions.html#174354062">Mario Carneiro (Aug 28 2019 at 11:48)</a>:</h4>
<p>Yes, we've done that in class before</p>

<a name="174354103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/CNF%20transformation%20of%20Propositional%20expressions/near/174354103" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/51898CNFtransformationofPropositionalexpressions.html#174354103">Mario Carneiro (Aug 28 2019 at 11:49)</a>:</h4>
<p>The simple way is to use a carefully chosen simp set</p>

<a name="174354157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/CNF%20transformation%20of%20Propositional%20expressions/near/174354157" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/51898CNFtransformationofPropositionalexpressions.html#174354157">Mario Carneiro (Aug 28 2019 at 11:50)</a>:</h4>
<p>The more efficient way is to prove it by recursion on the term</p>

<a name="174355564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/CNF%20transformation%20of%20Propositional%20expressions/near/174355564" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/51898CNFtransformationofPropositionalexpressions.html#174355564">Alexandre Rademaker (Aug 28 2019 at 12:12)</a>:</h4>
<p>Hi Mario , can you share examples? It is still not clear to me how implement this kind of computation in Lean. Have  you implemented it over the type Prop or implemented your on data type for formulas and functions over this type?</p>

<a name="174356007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/CNF%20transformation%20of%20Propositional%20expressions/near/174356007" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/51898CNFtransformationofPropositionalexpressions.html#174356007">Alexandre Rademaker (Aug 28 2019 at 12:19)</a>:</h4>
<p>(deleted)</p>

<a name="174403931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/CNF%20transformation%20of%20Propositional%20expressions/near/174403931" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/51898CNFtransformationofPropositionalexpressions.html#174403931">Mario Carneiro (Aug 28 2019 at 21:45)</a>:</h4>
<p><span class="user-mention" data-user-id="121542">@Alexandre Rademaker</span><br>
Since I like to give this as an exercise, I won't give exactly CNF, but here's a similar implementation for NNF (negation normal form), which turns everything into 'and', 'or', and negations of propositional atoms.</p>
<p>Method 1, using <code>simp</code>:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">logic</span><span class="bp">.</span><span class="n">basic</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">nnf₁</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="bp">`</span><span class="o">[</span><span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">iff_def</span><span class="o">,</span> <span class="n">classical</span><span class="bp">.</span><span class="n">imp_iff_not_or</span><span class="o">,</span> <span class="n">not_or_distrib</span><span class="o">,</span> <span class="n">classical</span><span class="bp">.</span><span class="n">not_and_distrib</span><span class="o">]]</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="n">r</span> <span class="n">s</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">p</span> <span class="bp">→</span> <span class="o">(</span><span class="n">q</span> <span class="bp">→</span> <span class="n">r</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">r</span> <span class="bp">→</span> <span class="n">s</span><span class="o">))</span> <span class="bp">∨</span> <span class="n">p</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">nnf₁</span> <span class="c1">-- ⊢ (¬p ∨ (¬q ∨ r) ∧ (¬r ∨ s)) ∨ p</span>
</pre></div>


<p>Method 2, by recursion:</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">nnf</span><span class="bp">.</span><span class="n">iff</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="n">r</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="o">(</span><span class="n">p</span> <span class="bp">→</span> <span class="n">q</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">q</span> <span class="bp">→</span> <span class="n">p</span><span class="o">)</span> <span class="bp">↔</span> <span class="n">r</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">p</span> <span class="bp">↔</span> <span class="n">q</span><span class="o">)</span> <span class="bp">↔</span> <span class="n">r</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">h</span><span class="o">,</span> <span class="bp">@</span><span class="n">iff_def</span> <span class="n">p</span> <span class="n">q</span><span class="o">]</span>
<span class="kn">theorem</span> <span class="n">nnf</span><span class="bp">.</span><span class="n">imp</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="n">r</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="o">(</span><span class="bp">¬</span> <span class="n">p</span> <span class="bp">∨</span> <span class="n">q</span><span class="o">)</span> <span class="bp">↔</span> <span class="n">r</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">p</span> <span class="bp">→</span> <span class="n">q</span><span class="o">)</span> <span class="bp">↔</span> <span class="n">r</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">h</span><span class="o">,</span> <span class="n">classical</span><span class="bp">.</span><span class="n">imp_iff_not_or</span><span class="o">]</span>
<span class="kn">theorem</span> <span class="n">nnf</span><span class="bp">.</span><span class="n">not_and</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="n">p&#39;</span> <span class="n">q&#39;</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">p</span> <span class="bp">↔</span> <span class="n">p&#39;</span><span class="o">)</span> <span class="o">(</span><span class="n">hq</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">q</span> <span class="bp">↔</span> <span class="n">q&#39;</span><span class="o">)</span> <span class="o">:</span> <span class="bp">¬</span> <span class="o">(</span><span class="n">p</span> <span class="bp">∧</span> <span class="n">q</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">p&#39;</span> <span class="bp">∨</span> <span class="n">q&#39;</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">hp</span><span class="o">,</span> <span class="err">←</span> <span class="n">hq</span><span class="o">,</span> <span class="n">classical</span><span class="bp">.</span><span class="n">not_and_distrib</span><span class="o">]</span>
<span class="kn">theorem</span> <span class="n">nnf</span><span class="bp">.</span><span class="n">not_or</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="n">p&#39;</span> <span class="n">q&#39;</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">p</span> <span class="bp">↔</span> <span class="n">p&#39;</span><span class="o">)</span> <span class="o">(</span><span class="n">hq</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">q</span> <span class="bp">↔</span> <span class="n">q&#39;</span><span class="o">)</span> <span class="o">:</span> <span class="bp">¬</span> <span class="o">(</span><span class="n">p</span> <span class="bp">∨</span> <span class="n">q</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">p&#39;</span> <span class="bp">∧</span> <span class="n">q&#39;</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">hp</span><span class="o">,</span> <span class="err">←</span> <span class="n">hq</span><span class="o">,</span> <span class="n">not_or_distrib</span><span class="o">]</span>
<span class="kn">theorem</span> <span class="n">nnf</span><span class="bp">.</span><span class="n">and</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="n">p&#39;</span> <span class="n">q&#39;</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">↔</span> <span class="n">p&#39;</span><span class="o">)</span> <span class="o">(</span><span class="n">hq</span> <span class="o">:</span> <span class="n">q</span> <span class="bp">↔</span> <span class="n">q&#39;</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">p</span> <span class="bp">∧</span> <span class="n">q</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">p&#39;</span> <span class="bp">∧</span> <span class="n">q&#39;</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hp</span><span class="o">,</span> <span class="n">hq</span><span class="o">]</span>
<span class="kn">theorem</span> <span class="n">nnf</span><span class="bp">.</span><span class="n">or</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="n">p&#39;</span> <span class="n">q&#39;</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">↔</span> <span class="n">p&#39;</span><span class="o">)</span> <span class="o">(</span><span class="n">hq</span> <span class="o">:</span> <span class="n">q</span> <span class="bp">↔</span> <span class="n">q&#39;</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">p</span> <span class="bp">∨</span> <span class="n">q</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">p&#39;</span> <span class="bp">∨</span> <span class="n">q&#39;</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hp</span><span class="o">,</span> <span class="n">hq</span><span class="o">]</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">nnf₂_aux</span> <span class="o">:</span> <span class="n">expr</span> <span class="bp">→</span> <span class="n">expr</span> <span class="bp">×</span> <span class="n">expr</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">(</span><span class="err">%%</span><span class="n">a</span> <span class="bp">↔</span> <span class="err">%%</span><span class="n">b</span><span class="o">)</span> <span class="o">:=</span>
  <span class="k">let</span> <span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="n">p</span><span class="o">)</span> <span class="o">:=</span> <span class="n">nnf₂_aux</span> <span class="bp">`</span><span class="o">(((</span><span class="err">%%</span><span class="n">a</span><span class="o">:</span><span class="kt">Prop</span><span class="o">)</span> <span class="bp">→</span> <span class="err">%%</span><span class="n">b</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">((</span><span class="err">%%</span><span class="n">b</span><span class="o">:</span><span class="kt">Prop</span><span class="o">)</span> <span class="bp">→</span> <span class="err">%%</span><span class="n">a</span><span class="o">))</span> <span class="k">in</span>
  <span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="bp">`</span><span class="o">(</span><span class="n">nnf</span><span class="bp">.</span><span class="n">iff</span> <span class="err">%%</span><span class="n">a</span> <span class="err">%%</span><span class="n">b</span> <span class="err">%%</span><span class="n">e</span> <span class="err">%%</span><span class="n">p</span><span class="o">))</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">(</span><span class="err">%%</span><span class="n">a</span> <span class="bp">→</span> <span class="err">%%</span><span class="n">b</span><span class="o">)</span> <span class="o">:=</span>
  <span class="k">let</span> <span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="n">p</span><span class="o">)</span> <span class="o">:=</span> <span class="n">nnf₂_aux</span> <span class="bp">`</span><span class="o">(</span><span class="bp">¬</span> <span class="err">%%</span><span class="n">a</span> <span class="bp">∨</span> <span class="err">%%</span><span class="n">b</span><span class="o">)</span> <span class="k">in</span>
  <span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="bp">`</span><span class="o">(</span><span class="n">nnf</span><span class="bp">.</span><span class="n">imp</span> <span class="err">%%</span><span class="n">a</span> <span class="err">%%</span><span class="n">b</span> <span class="err">%%</span><span class="n">e</span> <span class="err">%%</span><span class="n">p</span><span class="o">))</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">(</span><span class="err">%%</span><span class="n">a</span> <span class="bp">∨</span> <span class="err">%%</span><span class="n">b</span><span class="o">)</span> <span class="o">:=</span>
  <span class="k">let</span> <span class="o">(</span><span class="n">a&#39;</span><span class="o">,</span> <span class="n">ha</span><span class="o">)</span> <span class="o">:=</span> <span class="n">nnf₂_aux</span> <span class="n">a</span><span class="o">,</span> <span class="o">(</span><span class="n">b&#39;</span><span class="o">,</span> <span class="n">hb</span><span class="o">)</span> <span class="o">:=</span> <span class="n">nnf₂_aux</span> <span class="n">b</span> <span class="k">in</span>
  <span class="o">(</span><span class="bp">`</span><span class="o">(</span><span class="err">%%</span><span class="n">a&#39;</span> <span class="bp">∨</span> <span class="err">%%</span><span class="n">b&#39;</span><span class="o">),</span> <span class="bp">`</span><span class="o">(</span><span class="n">nnf</span><span class="bp">.</span><span class="n">or</span> <span class="err">%%</span><span class="n">a</span> <span class="err">%%</span><span class="n">b</span> <span class="err">%%</span><span class="n">a&#39;</span> <span class="err">%%</span><span class="n">b&#39;</span> <span class="err">%%</span><span class="n">ha</span> <span class="err">%%</span><span class="n">hb</span><span class="o">))</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">(</span><span class="err">%%</span><span class="n">a</span> <span class="bp">∧</span> <span class="err">%%</span><span class="n">b</span><span class="o">)</span> <span class="o">:=</span>
  <span class="k">let</span> <span class="o">(</span><span class="n">a&#39;</span><span class="o">,</span> <span class="n">ha</span><span class="o">)</span> <span class="o">:=</span> <span class="n">nnf₂_aux</span> <span class="n">a</span><span class="o">,</span> <span class="o">(</span><span class="n">b&#39;</span><span class="o">,</span> <span class="n">hb</span><span class="o">)</span> <span class="o">:=</span> <span class="n">nnf₂_aux</span> <span class="n">b</span> <span class="k">in</span>
  <span class="o">(</span><span class="bp">`</span><span class="o">(</span><span class="err">%%</span><span class="n">a&#39;</span> <span class="bp">∧</span> <span class="err">%%</span><span class="n">b&#39;</span><span class="o">),</span> <span class="bp">`</span><span class="o">(</span><span class="n">nnf</span><span class="bp">.</span><span class="n">and</span> <span class="err">%%</span><span class="n">a</span> <span class="err">%%</span><span class="n">b</span> <span class="err">%%</span><span class="n">a&#39;</span> <span class="err">%%</span><span class="n">b&#39;</span> <span class="err">%%</span><span class="n">ha</span> <span class="err">%%</span><span class="n">hb</span><span class="o">))</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">(</span><span class="bp">¬</span> <span class="o">(</span><span class="err">%%</span><span class="n">a</span> <span class="bp">∧</span> <span class="err">%%</span><span class="n">b</span><span class="o">))</span> <span class="o">:=</span>
  <span class="k">let</span> <span class="o">(</span><span class="n">a&#39;</span><span class="o">,</span> <span class="n">ha</span><span class="o">)</span> <span class="o">:=</span> <span class="n">nnf₂_aux</span> <span class="bp">`</span><span class="o">(</span><span class="bp">¬</span> <span class="err">%%</span><span class="n">a</span><span class="o">),</span> <span class="o">(</span><span class="n">b&#39;</span><span class="o">,</span> <span class="n">hb</span><span class="o">)</span> <span class="o">:=</span> <span class="n">nnf₂_aux</span> <span class="bp">`</span><span class="o">(</span><span class="bp">¬</span> <span class="err">%%</span><span class="n">b</span><span class="o">)</span> <span class="k">in</span>
  <span class="o">(</span><span class="bp">`</span><span class="o">(</span><span class="err">%%</span><span class="n">a&#39;</span> <span class="bp">∨</span> <span class="err">%%</span><span class="n">b&#39;</span><span class="o">),</span> <span class="bp">`</span><span class="o">(</span><span class="n">nnf</span><span class="bp">.</span><span class="n">not_and</span> <span class="err">%%</span><span class="n">a</span> <span class="err">%%</span><span class="n">b</span> <span class="err">%%</span><span class="n">a&#39;</span> <span class="err">%%</span><span class="n">b&#39;</span> <span class="err">%%</span><span class="n">ha</span> <span class="err">%%</span><span class="n">hb</span><span class="o">))</span>
<span class="bp">|</span> <span class="bp">`</span><span class="o">(</span><span class="bp">¬</span> <span class="o">(</span><span class="err">%%</span><span class="n">a</span> <span class="bp">∨</span> <span class="err">%%</span><span class="n">b</span><span class="o">))</span> <span class="o">:=</span>
  <span class="k">let</span> <span class="o">(</span><span class="n">a&#39;</span><span class="o">,</span> <span class="n">ha</span><span class="o">)</span> <span class="o">:=</span> <span class="n">nnf₂_aux</span> <span class="bp">`</span><span class="o">(</span><span class="bp">¬</span> <span class="err">%%</span><span class="n">a</span><span class="o">),</span> <span class="o">(</span><span class="n">b&#39;</span><span class="o">,</span> <span class="n">hb</span><span class="o">)</span> <span class="o">:=</span> <span class="n">nnf₂_aux</span> <span class="bp">`</span><span class="o">(</span><span class="bp">¬</span> <span class="err">%%</span><span class="n">b</span><span class="o">)</span> <span class="k">in</span>
  <span class="o">(</span><span class="bp">`</span><span class="o">(</span><span class="err">%%</span><span class="n">a&#39;</span> <span class="bp">∧</span> <span class="err">%%</span><span class="n">b&#39;</span><span class="o">),</span> <span class="bp">`</span><span class="o">(</span><span class="n">nnf</span><span class="bp">.</span><span class="n">not_or</span> <span class="err">%%</span><span class="n">a</span> <span class="err">%%</span><span class="n">b</span> <span class="err">%%</span><span class="n">a&#39;</span> <span class="err">%%</span><span class="n">b&#39;</span> <span class="err">%%</span><span class="n">ha</span> <span class="err">%%</span><span class="n">hb</span><span class="o">))</span>
<span class="bp">|</span> <span class="n">e</span> <span class="o">:=</span> <span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="bp">`</span><span class="o">(</span><span class="n">iff</span><span class="bp">.</span><span class="n">refl</span> <span class="err">%%</span><span class="n">e</span><span class="o">))</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">nnf₂</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="n">do</span> <span class="n">e</span> <span class="err">←</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">target</span><span class="o">,</span>
   <span class="k">let</span> <span class="o">(</span><span class="n">e&#39;</span><span class="o">,</span> <span class="n">p</span><span class="o">)</span> <span class="o">:=</span> <span class="n">nnf₂_aux</span> <span class="n">e</span><span class="o">,</span>
   <span class="n">tactic</span><span class="bp">.</span><span class="n">refine</span> <span class="bp">``</span><span class="o">(</span><span class="bp">@</span><span class="n">iff</span><span class="bp">.</span><span class="n">mpr</span> <span class="err">%%</span><span class="n">e</span> <span class="err">%%</span><span class="n">e&#39;</span> <span class="err">%%</span><span class="n">p</span> <span class="bp">_</span><span class="o">)</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="n">r</span> <span class="n">s</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">p</span> <span class="bp">→</span> <span class="o">(</span><span class="n">q</span> <span class="bp">→</span> <span class="n">r</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">r</span> <span class="bp">→</span> <span class="n">s</span><span class="o">))</span> <span class="bp">∨</span> <span class="n">p</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">nnf₂</span> <span class="c1">-- ⊢ (¬p ∨ (¬q ∨ r) ∧ (¬r ∨ s)) ∨ p</span>
</pre></div>


{% endraw %}

{% include archive_update.html %}