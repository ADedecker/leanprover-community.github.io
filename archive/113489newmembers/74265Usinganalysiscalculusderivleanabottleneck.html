---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113489newmembers/74265Usinganalysiscalculusderivleanabottleneck.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/74265Usinganalysiscalculusderivleanabottleneck.html">Using analysis/calculus/deriv.lean a bottleneck</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="187941657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20analysis/calculus/deriv.lean%20a%20bottleneck/near/187941657" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/74265Usinganalysiscalculusderivleanabottleneck.html#187941657">Daniel Keys (Feb 11 2020 at 18:52)</a>:</h4>
<p>Hi all: I've been trying to get started using this:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">calculus</span><span class="bp">.</span><span class="n">deriv</span>

<span class="n">def</span> <span class="n">twoX</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">x</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">twoX</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">has_deriv_at</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">has_deriv_at</span> <span class="n">twoX</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span>
</pre></div>


<p>Lean seems to become angry. It took several good minutes for the imports to load on a Macbook (one could easily get fried eggs on it after that), then for a couple seconds I did see the check passed, then I got this:</p>
<div class="codehilite"><pre><span></span><span class="n">checkDerivatives</span><span class="bp">.</span><span class="n">lean</span><span class="o">:</span><span class="mi">6</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span>
<span class="n">excessive</span> <span class="n">memory</span> <span class="n">consumption</span> <span class="n">detected</span> <span class="n">at</span> <span class="err">&#39;</span><span class="n">replace&#39;</span> <span class="o">(</span><span class="n">potential</span> <span class="n">solution</span><span class="o">:</span> <span class="n">increase</span> <span class="n">memory</span> <span class="n">consumption</span> <span class="n">threshold</span><span class="o">)</span>
</pre></div>


<p>Should I increase that memory threshold -  and if yes how?</p>

<a name="187941767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20analysis/calculus/deriv.lean%20a%20bottleneck/near/187941767" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/74265Usinganalysiscalculusderivleanabottleneck.html#187941767">Johan Commelin (Feb 11 2020 at 18:53)</a>:</h4>
<p>Probably you haven't compiled mathlib</p>

<a name="187941817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20analysis/calculus/deriv.lean%20a%20bottleneck/near/187941817" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/74265Usinganalysiscalculusderivleanabottleneck.html#187941817">Johan Commelin (Feb 11 2020 at 18:54)</a>:</h4>
<p>So it's starting to do a whole bunch of compilations when you open that file.</p>

<a name="187941856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20analysis/calculus/deriv.lean%20a%20bottleneck/near/187941856" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/74265Usinganalysiscalculusderivleanabottleneck.html#187941856">Johan Commelin (Feb 11 2020 at 18:54)</a>:</h4>
<p><span class="user-mention" data-user-id="259186">@Daniel Keys</span> Is this file in a project that depends on mathlib? Or are you working directly on a clone of mathlib?</p>

<a name="187941913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Using%20analysis/calculus/deriv.lean%20a%20bottleneck/near/187941913" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/74265Usinganalysiscalculusderivleanabottleneck.html#187941913">Johan Commelin (Feb 11 2020 at 18:55)</a>:</h4>
<p>In the first case, run <code>update-mathlib</code>. In the second case <code>cache-olean --fetch</code>.</p>


{% endraw %}

{% include archive_update.html %}