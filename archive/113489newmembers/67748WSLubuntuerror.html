---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113489newmembers/67748WSLubuntuerror.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html">WSL ubuntu error</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="182132062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182132062" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182132062">Jason KY. (Nov 28 2019 at 19:39)</a>:</h4>
<p>Hi! <br>
I'm trying to install mathlib on Ubuntu running in a WSL (in order to use format lean) but this happens,</p>
<div class="codehilite"><pre><span></span>curl https://raw.githubusercontent.com/leanprover-community/mathlib-tools/master/scripts/remote-install-update-mathlib.sh -sSf | bash
Installing python dependencies (at user level)
/home/jasonky/.virtualenvs/format_lean/bin/pip3
ERROR: Can not perform a &#39;--user&#39; install. User site-packages are not visible in this virtualenv.
</pre></div>


<p>Thanks in advance for any help!</p>

<a name="182133916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182133916" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182133916">Andrew Ashworth (Nov 28 2019 at 20:20)</a>:</h4>
<p>This is a bit non-standard. You will need to install mathlib the standard way via leanpkg, and then compile it. The problem is with your use of a virtual environment, and a conflict with pip.</p>

<a name="182134025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182134025" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182134025">Jason KY. (Nov 28 2019 at 20:23)</a>:</h4>
<p>I see... Sadly format lean requires the virtual environment to work :( But I guess I can always compile the LEAN code individually and then compile (and it works!)</p>

<a name="182134167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182134167" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182134167">Andrew Ashworth (Nov 28 2019 at 20:26)</a>:</h4>
<p>I don't think it would be a big deal if you have some shell scripting experience to fix <code>remote-install-update-mathlib</code>? I can't help you there, though, since I personally do not use the community mathlib update scripts.</p>

<a name="182134981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182134981" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182134981">Jason KY. (Nov 28 2019 at 20:46)</a>:</h4>
<p>Ahh.. I'll see if I can make something happen! Thanks for the help!</p>

<a name="182233000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182233000" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182233000">Patrick Massot (Nov 30 2019 at 10:09)</a>:</h4>
<p><span class="user-mention" data-user-id="243312">@Jason KY.</span>  Why do you say <code>format_lean</code> <em>needs</em> a virtual env? The documentation may recommend it, but there is nothing preventing you to install it in your global user space or even system-wide.</p>

<a name="182233280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182233280" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182233280">Patrick Massot (Nov 30 2019 at 10:18)</a>:</h4>
<p>It's tricky to support all kinds of setup. We really need to write more levels of instructions. We need both simpler instructions for people who want Lean+precompiled mathlib without all the tooling and more detailed instructions. However the ultimate documentation for those mathlib tools are the bash scripts and python source code. That <code>remote-install-update-mathlib</code> actually does very little, especially if you want only <code>update-mathlib</code>, which is by far the most useful tool here. In the end, you want to be able to run the python program <code>https://github.com/leanprover-community/mathlib-tools/blob/master/scripts/update-mathlib.py</code>. So it needs to be found by your system, and its python dependencies need to be found. Every trick to make that happen in any given setup is allowed.</p>
<p>The external dependencies are listed <a href="https://github.com/leanprover-community/mathlib-tools/blob/3a5af79dde17b20296c58863ac234f9945e11e36/scripts/remote-install-update-mathlib.sh#L5" target="_blank" title="https://github.com/leanprover-community/mathlib-tools/blob/3a5af79dde17b20296c58863ac234f9945e11e36/scripts/remote-install-update-mathlib.sh#L5">here</a> as they appear on <a href="https://pypi.org" target="_blank" title="https://pypi.org">PyPi</a> and can be fetched by the python package installer <code>pip</code>. I think the only internal dependency is <a href="https://github.com/leanprover-community/mathlib-tools/blob/master/scripts/auth_github.py" target="_blank" title="https://github.com/leanprover-community/mathlib-tools/blob/master/scripts/auth_github.py">https://github.com/leanprover-community/mathlib-tools/blob/master/scripts/auth_github.py</a>.</p>

<a name="182238498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182238498" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182238498">Jason KY. (Nov 30 2019 at 13:03)</a>:</h4>
<p>I see! I assumed that <code>format_lean</code> needed the virtual environment since that's what it said on the installation guide. I'll try reinstalling it globally and perhaps that will work better!</p>

<a name="182238726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182238726" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182238726">Kevin Buzzard (Nov 30 2019 at 13:11)</a>:</h4>
<p>You're using a virtual Ubuntu on a windows machine, right? Is there anything stopping you just installing it on Windows?</p>

<a name="182239998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182239998" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182239998">Jason KY. (Nov 30 2019 at 13:52)</a>:</h4>
<p>I don't know how to install it on windows since there's no documentation about it (and I'm not techy enough to know how to) :/</p>

<a name="182246883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182246883" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182246883">Kevin Buzzard (Nov 30 2019 at 17:06)</a>:</h4>
<p>Why not just install python 3.7 on Windows following some google instructions and then download a command line terminal and type in the commands in the installation instructions? I don't know much about Windows but I don't really see why this wouldn't work. Just make sure the python exe is in the path for the terminal.</p>

<a name="182251594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182251594" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182251594">Jason KY. (Nov 30 2019 at 19:18)</a>:</h4>
<p>I tried this and it <em>almost</em> worked! But it broke once I tried to compile the lean files saying <code>TypeError: argument of type 'WindowsPath' is not iterable</code>. I don't believe this to be a Python path issue, should it? My Python works fine in the terminal otherwise.</p>

<a name="182252295"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182252295" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182252295">Bryan Gin-ge Chen (Nov 30 2019 at 19:39)</a>:</h4>
<p>Did the error give you a file and line number? You may be able to fix that by changing that line in the Python so that it uses the <code>.name</code> field of the WindowsPath object.</p>

<a name="182252668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182252668" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182252668">Jason KY. (Nov 30 2019 at 19:50)</a>:</h4>
<div class="codehilite"><pre><span></span>Traceback (most recent call last):
  File &quot;C:/Users/Jason/AppData/Local/Programs/Python/Python37-32/Scripts/format_project&quot;, line 156, in &lt;module&gt;
    Fire(render_lean_project)
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\site-packages\fire\core.py&quot;, line 138, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\site-packages\fire\core.py&quot;, line 471, in _Fire
    target=component.__name__)
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\site-packages\fire\core.py&quot;, line 675, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File &quot;C:/Users/Jason/AppData/Local/Programs/Python/Python37-32/Scripts/format_project&quot;, line 119, in render_lean_project
    TradBegin, TradEnd])
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\site-packages\format_lean\line_reader.py&quot;, line 24, in __init__
    self.server = Server(lean_exec_path, lean_path)
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\site-packages\format_lean\server.py&quot;, line 15, in __init__
    env={&#39;LEAN_PATH&#39;: lean_path})
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\subprocess.py&quot;, line 775, in __init__
    restore_signals, start_new_session)
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\subprocess.py&quot;, line 1119, in _execute_child
    args = list2cmdline(args)
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\subprocess.py&quot;, line 530, in list2cmdline
    needquote = (&quot; &quot; in arg) or (&quot;\t&quot; in arg) or not arg
TypeError: argument of type &#39;WindowsPath&#39; is not iterable
</pre></div>


<p>This is the entire message.  I'm not sure if I should mess around with these codes if I don't know what I'm doing :P</p>

<a name="182253139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182253139" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182253139">Bryan Gin-ge Chen (Nov 30 2019 at 20:04)</a>:</h4>
<p>Could you try running <code>format_project --debug</code>? I'm curious what kind of object <code>lean_exec_path</code> is. I suspect that <code>lean_exec_path</code> needs to be converted to a string somewhere along the way.</p>

<a name="182253289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182253289" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182253289">Jason KY. (Nov 30 2019 at 20:08)</a>:</h4>
<p>This is what <code>format_project --debug</code> gives me:</p>
<div class="codehilite"><pre><span></span>$ format_project --debug
Lean executable path: C:\Users\Jason\.elan\toolchains\3.4.2\bin\lean
LEAN_PATH: C:\Users\Jason\.elan\toolchains\3.4.2\bin\..\lib\lean\library:C:\Users\Jason\AppData\Local\Packages\CanonicalGroupLimited.Ubuntu16.04onWindows_79rhkp1fndgsc\LocalState\rootfs\home\jasonky\M4000x_LEAN_formalisation\src:_target\deps\mathlib\src
Template folder: C:\users\jason\appdata\local\programs\python\python37-32\lib\site-packages\format_lean\templates
Tactic state filters:  []
Traceback (most recent call last):
  File &quot;C:/Users/Jason/AppData/Local/Programs/Python/Python37-32/Scripts/format_project&quot;, line 156, in &lt;module&gt;
    Fire(render_lean_project)
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\site-packages\fire\core.py&quot;, line 138, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\site-packages\fire\core.py&quot;, line 471, in _Fire
    target=component.__name__)
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\site-packages\fire\core.py&quot;, line 675, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File &quot;C:/Users/Jason/AppData/Local/Programs/Python/Python37-32/Scripts/format_project&quot;, line 119, in render_lean_project
    TradBegin, TradEnd])
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\site-packages\format_lean\line_reader.py&quot;, line 24, in __init__
    self.server = Server(lean_exec_path, lean_path)
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\site-packages\format_lean\server.py&quot;, line 15, in __init__
    env={&#39;LEAN_PATH&#39;: lean_path})
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\subprocess.py&quot;, line 775, in __init__
    restore_signals, start_new_session)
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\subprocess.py&quot;, line 1119, in _execute_child
    args = list2cmdline(args)
  File &quot;C:\users\jason\appdata\local\programs\python\python37-32\lib\subprocess.py&quot;, line 530, in list2cmdline
    needquote = (&quot; &quot; in arg) or (&quot;\t&quot; in arg) or not arg
TypeError: argument of type &#39;WindowsPath&#39; is not iterable
</pre></div>

<a name="182253575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182253575" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182253575">Bryan Gin-ge Chen (Nov 30 2019 at 20:16)</a>:</h4>
<p>Ah, OK, I guess this doesn't help much since <code>print</code> coerces objects to a string. The following might work (I can't test easily at the moment). Change <a href="https://github.com/leanprover-community/format_lean/blob/master/bin/format_project#L109" target="_blank" title="https://github.com/leanprover-community/format_lean/blob/master/bin/format_project#L109">this line</a> to this:</p>
<div class="codehilite"><pre><span></span>    <span class="n">lecture_reader</span> <span class="o">=</span> <span class="n">FileReader</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lean_exec_path</span><span class="p">),</span> <span class="n">lean_path</span><span class="p">,</span>
</pre></div>


<p>and then reinstall format_lean.</p>

<a name="182253827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182253827" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182253827">Jason KY. (Nov 30 2019 at 20:23)</a>:</h4>
<p>Emm... Now it gives no error but it's not compiling either :(</p>

<a name="182254771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182254771" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182254771">Bryan Gin-ge Chen (Nov 30 2019 at 20:50)</a>:</h4>
<p>What happens, exactly? Does the command successfully run with no output but nothing is added in the "outdir" that you specified? What does the file that you used for "inpath" look like?</p>

<a name="182254983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/WSL%20ubuntu%20error/near/182254983" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/67748WSLubuntuerror.html#182254983">Jason KY. (Nov 30 2019 at 20:56)</a>:</h4>
<p>I have <code>only = ['src/M40001/M40001.lean']</code>within my <code>format.toml</code>so I would expect it to compile the file indicated into the folder <code>html</code>. But when I run the command it creates some other files named <code>lecture</code> in <code>html</code>. The terminal itself does not return anything.</p>


{% endraw %}

{% include archive_update.html %}