---
layout: archive
title: Lean Prover Zulip Chat Archive
permalink: archive/113489newmembers/05853Proofsearch.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/113489newmembers/index.html">new members</a>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/113489newmembers/05853Proofsearch.html">Proof search</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com">

{% raw %}
<a name="178035658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Proof%20search/near/178035658" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/05853Proofsearch.html#178035658">Marko Grdinic (Oct 13 2019 at 12:06)</a>:</h4>
<p>I am working on a little proof and need to rewrite <code>sqr (a - b)</code> into <code>sqr a - 2 * a * b + sqr b</code>. Now of course I could define a postulate for this like I did in the Agda proof I am rewriting, but I am guessing that this is proven in the <code>mathlib</code> and Lean has some kind of proof search. In Coq I could write something like <code>Search (forall a b, sqr (a - b) = sqr a - 2 * a * b + sqr b).</code> What functionality for this sort of thing does Lean have?</p>

<a name="178037525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Proof%20search/near/178037525" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/05853Proofsearch.html#178037525">Chris Hughes (Oct 13 2019 at 13:06)</a>:</h4>
<p>The <code>ring</code> tactic should solve this. You'll need to use <code>^2</code> instead of <code>sqr</code> though.</p>

<a name="178038080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Proof%20search/near/178038080" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/05853Proofsearch.html#178038080">Floris van Doorn (Oct 13 2019 at 13:24)</a>:</h4>
<p>For searching, <code>library_search</code> is convenient:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">rat</span><span class="bp">.</span><span class="n">basic</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">library_search</span>

<span class="kn">example</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">}</span> <span class="o">:</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">b</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">library_search</span> <span class="c1">-- exact add_mul_self_eq a b</span>
</pre></div>

<a name="178038139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Proof%20search/near/178038139" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/05853Proofsearch.html#178038139">Floris van Doorn (Oct 13 2019 at 13:26)</a>:</h4>
<p>Oh wait, the minus sign got lost in translation. I don't think that particular lemma is in the library yet.</p>

<a name="178111436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Proof%20search/near/178111436" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/05853Proofsearch.html#178111436">Marko Grdinic (Oct 14 2019 at 15:10)</a>:</h4>
<p>Let me bring this subject up again as I am having some trouble. </p>
<div class="codehilite"><pre><span></span>1 goal
c x : ℚ,
l : list ℚ,
E.const_none : ∀ (l : list ℚ), monoid.pow c (list.length l) * rat.inv ↑(list.length l) = c ∨ l = list.nil
⊢ monoid.pow c (1 + list.length l) * rat.inv (1 + ↑(list.length l)) = c
</pre></div>


<p>Right now I have something like this in my tactic state and I want to search all the proofs involving <code>monoid.pow</code>. What would be the best way to go about this. <code>library_search</code> is not quite equivalent to Coq's <code>Search</code> as it is a tactic that fails or succeeds. Coq's <code>Search</code> can print out every function in which a term appears.</p>

<a name="178113220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Proof%20search/near/178113220" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/05853Proofsearch.html#178113220">Alex J. Best (Oct 14 2019 at 15:31)</a>:</h4>
<p>You can also use <code>set_option trace.library_search true</code> to have library_search list of all possible results matching a given type. Alternatively you can make an educated guess at names with a bit of grepping / text searching in vscode or whatever to find things, this is surprisingly effective because the mathlib naming scheme is quite rigid.</p>

<a name="178113672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Proof%20search/near/178113672" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/05853Proofsearch.html#178113672">Kevin Buzzard (Oct 14 2019 at 15:36)</a>:</h4>
<p>In tactic mode you can try <code>exact monoid.pow</code> and then ctrl-space and then maybe esc and ctrl-space again for good measure. This might give you a list of helpful things.</p>

<a name="178114600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Proof%20search/near/178114600" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/05853Proofsearch.html#178114600">Marko Grdinic (Oct 14 2019 at 15:48)</a>:</h4>
<blockquote>
<p>Coq's Search can print out every function in which a term appears.</p>
</blockquote>
<p>Actually, what I meant to write here is that it can print out every function <strong>in whose type</strong> a term appears which is very useful for searching through theorems of equalities. It is a powerful thing. I am not sure if it is on the requested features list, but if it is not, it definitely should be.</p>
<p><span class="user-mention" data-user-id="127136">@Alex J. Best</span> </p>
<blockquote>
<p>You can also use set_option trace.library_search true to have library_search list of all possible results matching a given type.</p>
</blockquote>
<p>I am not sure how to control <code>library_search</code> to just search it for equalities involving <code>monoid.pow</code>. Right now I just tried it and it gave me what seems to be an unordered list of 4k lemmas. It is not really quite the thing I am looking for.</p>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> </p>
<blockquote>
<p>In tactic mode you can try exact monoid.pow and then ctrl-space and then maybe esc and ctrl-space again for good measure. This might give you a list of helpful things.</p>
</blockquote>
<p>In VS Code that is the trigger for autosuggestion, I am not sure if you are using Emacs what is it there. One thing I do know is that Ctrl + click dives me into the implementation of a function which is useful, but not quite enough for me.</p>

<a name="178116538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Proof%20search/near/178116538" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/05853Proofsearch.html#178116538">Marko Grdinic (Oct 14 2019 at 16:13)</a>:</h4>
<p>For examples how Coq's <code>Search</code> works, check this out: <a href="https://softwarefoundations.cis.upenn.edu/vfa-current/Perm.html" target="_blank" title="https://softwarefoundations.cis.upenn.edu/vfa-current/Perm.html">https://softwarefoundations.cis.upenn.edu/vfa-current/Perm.html</a></p>
<p>It is the first chapter of vol 3 of Software Foundations.</p>

<a name="178117413"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Proof%20search/near/178117413" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/05853Proofsearch.html#178117413">Johan Commelin (Oct 14 2019 at 16:24)</a>:</h4>
<p><span class="user-mention" data-user-id="244262">@Marko Grdinic</span> You are trying to prove that <code>c ^ something = c</code>. You want to do this be claiming that <code>something = 1</code>. You can guess the name of the lemma that says <code>c ^ 1 = c</code>: it will/should/must/shall/ought be called <code>pow_one</code>. So you proceed by saying <code>convert pow_one c</code>. Now you are left with proving <code>something = 1</code>.</p>

<a name="178118194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Proof%20search/near/178118194" class="zl"><img src="https://leanprover-community.github.io/assets/img/zulip2.png" alt="view this post on Zulip"></a> <a href="https://leanprover-community.github.io/archive/113489newmembers/05853Proofsearch.html#178118194">Andrew Ashworth (Oct 14 2019 at 16:35)</a>:</h4>
<p>Yes. Many of us are aware of how <code>library_search</code> is different from Coq <code>search</code>. Actually there was some brief talk awhile back about ambitious projects like coding up a Hoogle-alike, but it never went anywhere because most people are OK with what we have (some mixture of grep, library_search, and VSCode autocomplete + naming conventions). That is not to say that if you wanted to have a Search tactic in mathlib, that pull request would not be accepted. Although I'm not a maintainer, but generally they are pretty receptive to these things.</p>


{% endraw %}

{% include archive_update.html %}