---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/144837PRreviews/22086391faster.html
---

## Stream: [PR reviews](index.html)
### Topic: [#391 faster](22086391faster.html)

---


{% raw %}
#### [ Kenny Lau (Oct 07 2018 at 13:21)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349088):
<p>How can I improve <a href="https://github.com/leanprover/mathlib/pull/391" target="_blank" title="https://github.com/leanprover/mathlib/pull/391">the <code>faster</code> PR</a>?</p>

#### [ Scott Morrison (Oct 07 2018 at 13:22)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349130):
<p>I was wondering, Kenny, if it makes sense to rebase it onto the squeeze-simp PR?</p>

#### [ Scott Morrison (Oct 07 2018 at 13:22)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349132):
<p>Presumably that one will be reviewed and merged first, since <code>faster</code> relies on it.</p>

#### [ Scott Morrison (Oct 07 2018 at 13:23)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349138):
<p>If you like I can try doing that. If you don't mind compressing everything into a single commit it should be easy.</p>

#### [ Scott Morrison (Oct 07 2018 at 13:23)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349139):
<p>Possibly harder if you want to preserve the individual commits, but leave out the ones that have already been separated out into <code>squeeze-simp</code>.</p>

#### [ Kenny Lau (Oct 07 2018 at 13:24)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349179):
<p>I'll rebase it onto <code>squeeze-simp</code> once it (i.e. <code>squeeze-simp</code>) has been merged</p>

#### [ Scott Morrison (Oct 07 2018 at 13:28)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349283):
<p>Ok, I guess that's fine. It's just a piece of cleaning up work that you could do already if you're in a hurry.</p>

#### [ Scott Morrison (Oct 07 2018 at 13:28)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349284):
<p>I've had a scroll through the changes on this one, but I'm not really the one to comment. :-) Unreadable proofs beforehand, unreadable proofs afterwards, so if they're faster, I'd say go for it. :-)</p>

#### [ Kenny Lau (Oct 07 2018 at 13:29)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349287):
<p>Ok, thanks for your review</p>

#### [ Scott Morrison (Oct 07 2018 at 13:33)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349408):
<p>Some places make me a little sad:</p>

#### [ Scott Morrison (Oct 07 2018 at 13:33)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349409):
<p><a href="https://github.com/leanprover/mathlib/pull/391/files#diff-52b9e281e7667f88f8203fb617843d93L522" target="_blank" title="https://github.com/leanprover/mathlib/pull/391/files#diff-52b9e281e7667f88f8203fb617843d93L522">https://github.com/leanprover/mathlib/pull/391/files#diff-52b9e281e7667f88f8203fb617843d93L522</a></p>

#### [ Scott Morrison (Oct 07 2018 at 13:34)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349447):
<p>When the proof used to just be <code>simp</code>, and now it's some rewrite.</p>

#### [ Kenny Lau (Oct 07 2018 at 13:34)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349455):
<p>it saves a lot of speed though...</p>

#### [ Scott Morrison (Oct 07 2018 at 13:35)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349463):
<p>Yes, but it's a tradeoff. It's very sad to have to write proofs of such simple things. I agree in the short term it's worth saving the speed.</p>

#### [ Scott Morrison (Oct 07 2018 at 13:35)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349464):
<p>But in the long run, I have to say that this is the most depressing thing I've seen in Lean yet --- the fact that we are having to do this.</p>

#### [ Scott Morrison (Oct 07 2018 at 13:36)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349507):
<p>I noticed there are some actual new features hiding in here: <a href="https://github.com/leanprover/mathlib/pull/391/files#diff-47cbe97193e277c9a413e62bc8afadff" target="_blank" title="https://github.com/leanprover/mathlib/pull/391/files#diff-47cbe97193e277c9a413e62bc8afadff">https://github.com/leanprover/mathlib/pull/391/files#diff-47cbe97193e277c9a413e62bc8afadff</a></p>

#### [ Scott Morrison (Oct 07 2018 at 13:37)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349513):
<p>You should almost certainly take these out, and make a separate PR for them.</p>

#### [ Scott Morrison (Oct 07 2018 at 13:38)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349517):
<p>Oh, I see, those are the parts that Simon wrote</p>

#### [ Scott Morrison (Oct 07 2018 at 13:38)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349556):
<p>and that are in the separate PR already.</p>

#### [ Scott Morrison (Oct 07 2018 at 13:38)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349559):
<p>(This is exactly why I suggested rebasing now --- so it's easy for us to review it already!)</p>

#### [ Kenny Lau (Oct 07 2018 at 13:39)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349562):
<p>What do you mean by rebasing this PR onto squeeze_simp?</p>

#### [ Scott Morrison (Oct 07 2018 at 13:39)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349569):
<p>At the moment there is a fork in the history --- leading out of master is one sequence of commits leading to squeeze-simp</p>

#### [ Scott Morrison (Oct 07 2018 at 13:40)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349614):
<p>and another sequence of commits leading to faster</p>

#### [ Scott Morrison (Oct 07 2018 at 13:40)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349620):
<p>I was proposing making that history linear again, but so all of squeeze-simp comes first, and then the rest of faster</p>

#### [ Kenny Lau (Oct 07 2018 at 13:40)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349627):
<p>and how do I do that?</p>

#### [ Scott Morrison (Oct 07 2018 at 13:41)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349633):
<p>Well -- do we care if all your commits get smushed into a single one?</p>

#### [ Scott Morrison (Oct 07 2018 at 13:41)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349634):
<p>If that's okay, we can do a squash merge.</p>

#### [ Kenny Lau (Oct 07 2018 at 13:41)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349636):
<p>how does that work?</p>

#### [ Scott Morrison (Oct 07 2018 at 13:41)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349638):
<p>If that's not okay, I'd have to experiment --- it's at the limit of my rebase ability. :-)</p>

#### [ Scott Morrison (Oct 07 2018 at 13:41)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349640):
<p>To do a squash merge, you would:</p>

#### [ Scott Morrison (Oct 07 2018 at 13:42)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349642):
<p><code>git checkout squeeze-simp</code></p>

#### [ Scott Morrison (Oct 07 2018 at 13:42)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349681):
<p><code>git merge --squash faster</code></p>

#### [ Scott Morrison (Oct 07 2018 at 13:42)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349684):
<p>then look at the state of things, and make sure everything looks sane.</p>

#### [ Scott Morrison (Oct 07 2018 at 13:42)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349685):
<p>if it does:</p>

#### [ Scott Morrison (Oct 07 2018 at 13:42)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349686):
<p><code>git branch faster2</code></p>

#### [ Scott Morrison (Oct 07 2018 at 13:42)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349689):
<p><code>git checkout faster2</code></p>

#### [ Scott Morrison (Oct 07 2018 at 13:43)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349692):
<p><code>git commit -m "feat(*): make mathlib faster using simp only, rw, and rfl"</code></p>

#### [ Scott Morrison (Oct 07 2018 at 13:43)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349697):
<p>then if everything looks okay, delete the faster branch, and rename faster2 back to faster</p>

#### [ Scott Morrison (Oct 07 2018 at 13:43)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349698):
<p>and finally <code>git push --force community</code> to overwrite the old faster branch.</p>

#### [ Kenny Lau (Oct 07 2018 at 13:43)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349700):
<p>how will this make the tactic changes disappear from the "Files changed"?</p>

#### [ Scott Morrison (Oct 07 2018 at 13:43)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349705):
<p>So it won't do that immediately in files changed, but ...</p>

#### [ Kenny Lau (Oct 07 2018 at 13:44)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349745):
<p>but?</p>

#### [ Scott Morrison (Oct 07 2018 at 13:45)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349756):
<p>on the changes page, if you click on the <code>changes from all commits</code> text</p>

#### [ Scott Morrison (Oct 07 2018 at 13:45)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349757):
<p>you get an option to just compare across a range.</p>

#### [ Scott Morrison (Oct 07 2018 at 13:46)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349803):
<p>after the squash merge, the commits will be linearly ordered, so it's possible to just look at the changes after Simon was "finished" with squeeze-simp -- i.e. just showing yours</p>

#### [ Scott Morrison (Oct 07 2018 at 13:46)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349807):
<p>and posting the URL for that range here would give anyone easy access to it.</p>

#### [ Scott Morrison (Oct 07 2018 at 13:46)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349809):
<p>(I'm not strongly saying this is worth doing... it's a possibility if you want to clean up)</p>

#### [ Scott Morrison (Oct 07 2018 at 13:47)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349816):
<p>Another suggestion, for cleaning up, is that you change the name of the PR, e.g. to <code>feat(*): make mathlib faster using simp only, rw, and rfl</code></p>

#### [ Scott Morrison (Oct 07 2018 at 13:48)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349820):
<p>the convention is <code>XXX(FFF): CCC</code>, where <code>XXX</code> is <code>doc</code>, <code>feat</code>, <code>bug</code>, or <code>chore</code>, <code>FFF</code> is the files affected (perhaps abbreviated some way), and <code>CCC</code> is a short summary</p>

#### [ Scott Morrison (Oct 07 2018 at 13:48)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349861):
<p>When everything is finally merged, it will be squashed to a single commit, and it makes the maintainers life slightly easier if they've got a commit message in the right format in front of them.</p>

#### [ Kenny Lau (Oct 07 2018 at 13:49)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349865):
<p>what is <code>feat</code>?</p>

#### [ Mario Carneiro (Oct 07 2018 at 13:49)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349870):
<p>feature: it's for commits that add new stuff</p>

#### [ Mario Carneiro (Oct 07 2018 at 13:50)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349911):
<p>I think <code>faster</code> is a <code>refactor</code> commit</p>

#### [ Kenny Lau (Oct 07 2018 at 13:50)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349916):
<p>I don't think <code>refactor</code> is one of <code>doc</code>, <code>feat</code>, <code>bug</code>, or <code>chore</code></p>

#### [ Mario Carneiro (Oct 07 2018 at 13:51)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349917):
<p>The list is longer than that</p>

#### [ Johan Commelin (Oct 07 2018 at 13:51)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349922):
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Is there any reason why this PR is not a no-brainer?</p>

#### [ Kenny Lau (Oct 07 2018 at 13:51)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349923):
<p>where can I find the list?</p>

#### [ Mario Carneiro (Oct 07 2018 at 13:51)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349924):
<p><a href="https://github.com/leanprover/lean/blob/master/doc/commit_convention.md" target="_blank" title="https://github.com/leanprover/lean/blob/master/doc/commit_convention.md">https://github.com/leanprover/lean/blob/master/doc/commit_convention.md</a></p>

#### [ Mario Carneiro (Oct 07 2018 at 13:51)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349925):
<p>It's a large change, that's never a no-brainer</p>

#### [ Mario Carneiro (Oct 07 2018 at 13:52)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349966):
<p>Kenny could you not replace <code>induction</code> with <code>nat.rec_on</code>? It's less readable</p>

#### [ Scott Morrison (Oct 07 2018 at 13:53)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349969):
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span>, it's worth remembering that once a PR is in, little problems never get fixed again. :-)</p>

#### [ Scott Morrison (Oct 07 2018 at 13:53)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135349972):
<p>This is a one moment where there's a chance to get things right. Saying "oh, we can fix it later" turns out to be false in practice!</p>

#### [ Kenny Lau (Oct 07 2018 at 13:54)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350012):
<div class="codehilite"><pre><span></span>Kenny Lau@DESKTOP-F01EMD3 MINGW64 /c/mathlib
$ git branch
  direct_sum
* faster
  master
</pre></div>

#### [ Kenny Lau (Oct 07 2018 at 13:54)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350013):
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> how do I add <code>squeeze_simp</code> to this list?</p>

#### [ Scott Morrison (Oct 07 2018 at 13:55)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350021):
<p><code>git checkout squeeze-simp</code></p>

#### [ Scott Morrison (Oct 07 2018 at 13:55)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350022):
<p>(it's a hypen, not an underscore)</p>

#### [ Scott Morrison (Oct 07 2018 at 13:56)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350060):
<p>Do you have <code>community</code> set up as a remote?</p>

#### [ Kenny Lau (Oct 07 2018 at 13:56)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350063):
<p>yes</p>

#### [ Scott Morrison (Oct 07 2018 at 13:56)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350064):
<p>okay, then just <code>checkout</code> should be enough</p>

#### [ Kenny Lau (Oct 07 2018 at 13:57)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350067):
<div class="codehilite"><pre><span></span>Kenny Lau@DESKTOP-F01EMD3 MINGW64 /c/mathlib
$ git checkout squeeze-simp
error: pathspec &#39;squeeze-simp&#39; did not match any file(s) known to git.

Kenny Lau@DESKTOP-F01EMD3 MINGW64 /c/mathlib
$ git remote
lc
origin
</pre></div>

#### [ Scott Morrison (Oct 07 2018 at 13:58)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350115):
<p>What does <code>git remote get-url lc</code> say?</p>

#### [ Scott Morrison (Oct 07 2018 at 13:58)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350116):
<p>Have you run <code>git fetch</code>?</p>

#### [ Kenny Lau (Oct 07 2018 at 13:58)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350117):
<div class="codehilite"><pre><span></span>Kenny Lau@DESKTOP-F01EMD3 MINGW64 /c/mathlib
$ git remote get-url lc
https://github.com/leanprover-community/mathlib
</pre></div>

#### [ Scott Morrison (Oct 07 2018 at 13:58)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350118):
<p>You may need to do that, so it looks up all the available branches on that remote.</p>

#### [ Kenny Lau (Oct 07 2018 at 13:59)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350124):
<div class="codehilite"><pre><span></span>Kenny Lau@DESKTOP-F01EMD3 MINGW64 /c/mathlib
$ git fetch
remote: Enumerating objects: 13, done.
remote: Counting objects: 100% (13/13), done.
remote: Compressing objects: 100% (6/6), done.
remote: Total 13 (delta 7), reused 9 (delta 7), pack-reused 0
Unpacking objects: 100% (13/13), done.
From https://github.com/leanprover/mathlib
   0ddb58c..e4ce469  master     -&gt; origin/master

Kenny Lau@DESKTOP-F01EMD3 MINGW64 /c/mathlib
$ git checkout squeeze-simp
error: pathspec &#39;squeeze-simp&#39; did not match any file(s) known to git.
</pre></div>

#### [ Scott Morrison (Oct 07 2018 at 13:59)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350125):
<p>(By the way, you might like to learn how to use ssh URLs, rather than https ones, as then you can use an ssh key and never have to type a password.)</p>

#### [ Kenny Lau (Oct 07 2018 at 14:00)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350163):
<p>I suppose some of the words mean something</p>

#### [ Scott Morrison (Oct 07 2018 at 14:00)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350177):
<p>Hmm, I guess you'll need <code>git checkout -b squeeze-simp lc/squeeze-simp</code></p>

#### [ Scott Morrison (Oct 07 2018 at 14:00)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350179):
<p>Sorry, not sure why you can't just <code>checkout</code>, that seems to work for me.</p>

#### [ Scott Morrison (Oct 07 2018 at 14:01)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350187):
<blockquote>
<p>I suppose some of the words mean something</p>
</blockquote>
<p>I'll let you google them later. :-)</p>

#### [ Kenny Lau (Oct 07 2018 at 14:01)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350188):
<div class="codehilite"><pre><span></span>Kenny Lau@DESKTOP-F01EMD3 MINGW64 /c/mathlib
$ git checkout -b squeeze-simp lc/squeeze-simp
fatal: Cannot update paths and switch to branch &#39;squeeze-simp&#39; at the same time.
Did you intend to checkout &#39;lc/squeeze-simp&#39; which can not be resolved as commit?
</pre></div>

#### [ Scott Morrison (Oct 07 2018 at 14:03)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350239):
<p>ugh, sorry, you've exceeded my knowledge of git at this point.</p>

#### [ Mario Carneiro (Oct 07 2018 at 14:04)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350241):
<p><code>git checkout lc/squeeze-simp</code>?</p>

#### [ Scott Morrison (Oct 07 2018 at 14:04)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350280):
<p>ah --- also <code>git fetch lc</code> might be helpful</p>

#### [ Scott Morrison (Oct 07 2018 at 14:05)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350290):
<p>I forgot when you ran <code>git fetch</code> above it only fetched from <code>origin</code>.</p>

#### [ Kenny Lau (Oct 07 2018 at 14:06)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350332):
<blockquote>
<p><code>git checkout lc/squeeze-simp</code>?</p>
</blockquote>
<p>no <code>-b</code>?</p>

#### [ Scott Morrison (Oct 07 2018 at 14:07)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350340):
<p>I <em>think</em> if you run <code>git fetch lc</code> first, then both commands (with and without the <code>-b</code>) should have the same effect.</p>

#### [ Kenny Lau (Oct 07 2018 at 14:08)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350380):
<p>I don't think so</p>

#### [ Johan Commelin (Oct 07 2018 at 14:08)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350381):
<p>What does <code>git branch -a -v</code> give you?</p>

#### [ Kenny Lau (Oct 07 2018 at 14:08)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350384):
<div class="codehilite"><pre><span></span>$ git branch -a -v
* (HEAD detached at lc/squeeze-simp)   136ab4a Provide a means for other tactics to use squeeze
  direct_sum                           009b95f refactor dfinsupp again
  faster                               ddae2b2 chore(data/finsupp): reduce build time
  master                               6434658 [behind 40] feat(analysis/topology): locally compact spaces and the compact-open topology
  remotes/lc/applicative               7a57a7f fix(data/vector2): traversable instance
  remotes/lc/auto-cases-iff            4e7bcd6 add Johan&#39;s test case
  remotes/lc/basis                     e0db366 remove pempty_equiv_empty
  remotes/lc/bifunctor                 1b63bf6 change direction of composition law
  remotes/lc/cfsg                      b583ad0 a start on the statement of the classification of finite simple groups
  remotes/lc/cleanup                   6e9a638 cleanup
  remotes/lc/coinductive-fixes         d2fdb5c fix(tactic/eval_expr): often crashes when reflecting expressions
  remotes/lc/coinductive-types         bf5f318 [WIP] coinductive type families
  remotes/lc/completions               125efed fail(analysis/topology/completion): fail to get topological ring strucutre on separation quotient
  remotes/lc/determinants              9280cbf core(data/fin): cleanup fin proofs
  remotes/lc/direct_limit              9b8259f Update direct_limit.lean
  remotes/lc/direct_sum                009b95f refactor dfinsupp again
  remotes/lc/dvd_add-lemmas            a0c1deb adding two lemmas about division
  remotes/lc/eckmann-hilton            ddd03a1 feat(group_theory/eckmann_hilton): add Eckmann-Hilton
  remotes/lc/elan-docs                 1f2e745 noting additional prerequisite on macOS
  remotes/lc/eval-expr-fix             d2fdb5c fix(tactic/eval_expr): often crashes when reflecting expressions
  remotes/lc/exp                       f77c3fe fix build
  remotes/lc/ext                       2d3b8d3 feat(tactic/ext): remove lambda abstractions when inferring a type&#39;s name
  remotes/lc/ext-goal-ordering         bb1a40a adding configuration to non-interactive ext1
  remotes/lc/faster                    ddae2b2 chore(data/finsupp): reduce build time
  remotes/lc/fin_cases                 ab2d3e6 removing guard
  remotes/lc/finmap                    6863745 feat(data/finmap): change keys to finset
  remotes/lc/fold                      0919259 reformulate `fold` to use `monoid` rather than `applicative
  remotes/lc/hlist                     b5d6d60 [WIP] hlist type
  remotes/lc/inner_product_spaces      2203545 Update herm_inner_product_space.lean
  remotes/lc/integral                  0d10db9 fix eapprox
  remotes/lc/kmb_hilbert2              3683d9d Merge remote-tracking branch &#39;origin/module&#39; into kmb_hilbert2
  remotes/lc/kmb_hilbert_basis         651baa8 WIP
  remotes/lc/kmb_some_zerology         d3add5f fix(algebra/ring) : non_zero -&gt; nonzero
  remotes/lc/kmb_zerology              a7edb2c feat(ring_theory/noetherian): zero ring (and finite rings) are Noetherian
  remotes/lc/lean-3.3.0                6a2607e fix(data/rat): backport bugfix
  remotes/lc/lean-3.4.1                905345a fix(data/array/lemmas,...): fix build
  remotes/lc/master                    0ddb58c workaround(tactic/tfae): tfae is broken, comment out its tests (#398)
  remotes/lc/matrix                    3dd7f4d feat(ring_theory/matrix): category of free modules; scalar matrices
  remotes/lc/module                    335fab4 refactor(linear_algebra/dimension): update for new modules
  remotes/lc/monoid_stuff              519f6d6 style(algebra/group): fix alignment of code
  remotes/lc/monotonicity              1138482 fix(tactic/mono): fix conflict with `has_lt`
  remotes/lc/monotonicity-updated      366bd52 feat(tactic/mono): update traversable
  remotes/lc/normed_space_instance     82d95ba fix(analysis/normed_space): Add instance showing that normed field is a normed space over itself
  remotes/lc/poly_coeffs               92c2cfc feat(data/polynomial): coeff is R-linear
  remotes/lc/scott/supremum            8b22c4d Merge branch &#39;solve_by_elim_congr&#39; into scott/supremum
  remotes/lc/solve_by_elim_backtrack   501959b fix(data/real/cau_seq_filter): use new syntax for solve_by_elim
  remotes/lc/solve_by_elim_congr       fb5600b use non-interactive solve_by_elim in tfae
  remotes/lc/splitting_fields          9861ccd Work on lift
  remotes/lc/squeeze-simp              136ab4a Provide a means for other tactics to use squeeze
  remotes/lc/structure-stub            5f5e9b5 doc(hole/instance_stub)
  remotes/lc/subrings_subfields        986274a simplify a proof instance
  remotes/lc/sum-functor               d1cf30a feat(category/functor): make `sum` `functor` instance more universe polymorphic
  remotes/lc/sum-monad                 7e28be8 feat(data/sum): add monad instance
  remotes/lc/sylow                     cd0a486 Merge remote-tracking branch &#39;dorhinj/sylow&#39; into sylow
  remotes/lc/tensor-product            5226782 namespace
  remotes/lc/tfae                      8bc42a0 perf(tactic/scc): produce smaller proofs
  remotes/lc/traversable-derive-lawful e597516 chore(traversable): merge with Mario&#39;s branch
  remotes/lc/traverse-finset           477104e finset traversable: proof of composition law
  remotes/lc/tutorials                 09982a9 fix finset
  remotes/lc/whiskering                95ff94b Merge pull request #5 from rwbarton/whiskering
  remotes/origin/HEAD                  -&gt; origin/master
  remotes/origin/lean-3.3.0            6a2607e fix(data/rat): backport bugfix
  remotes/origin/lean-3.4.1            905345a fix(data/array/lemmas,...): fix build
  remotes/origin/master                e4ce469 fix(docs/elan): fix homebrew instructions for macOS (#395)
</pre></div>

#### [ Kenny Lau (Oct 07 2018 at 14:18)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350632):
<div class="codehilite"><pre><span></span>$ git branch faster2
warning: refname &#39;lc/squeeze-simp&#39; is ambiguous.
fatal: Ambiguous object name: &#39;lc/squeeze-simp&#39;.
</pre></div>

#### [ Kenny Lau (Oct 07 2018 at 14:18)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350633):
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span></p>

#### [ Scott Morrison (Oct 07 2018 at 14:19)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350641):
<p>oof, you've done something strange!</p>

#### [ Scott Morrison (Oct 07 2018 at 14:19)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350642):
<p>Let's try to get back to normal. <code>git checkout master</code></p>

#### [ Scott Morrison (Oct 07 2018 at 14:19)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350643):
<p>(perhaps copy and paste the outputs back here, so the peanut gallery can see what's going on)</p>

#### [ Kenny Lau (Oct 07 2018 at 14:20)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350688):
<p>and then?</p>

#### [ Scott Morrison (Oct 07 2018 at 14:20)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350691):
<p>What did <code>git checkout master</code> say?</p>

#### [ Kenny Lau (Oct 07 2018 at 14:20)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350695):
<div class="codehilite"><pre><span></span>$ git checkout master
Switched to branch &#39;master&#39;
Your branch is behind &#39;origin/master&#39; by 40 commits, and can be fast-forwarded.
  (use &quot;git pull&quot; to update your local branch)
</pre></div>

#### [ Scott Morrison (Oct 07 2018 at 14:21)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350701):
<p><code>git checkout squeeze-simp</code></p>

#### [ Kenny Lau (Oct 07 2018 at 14:21)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350707):
<div class="codehilite"><pre><span></span>$ git checkout squeeze-simp
Branch squeeze-simp set up to track remote branch squeeze-simp from lc.
Switched to a new branch &#39;squeeze-simp&#39;

Kenny Lau@DESKTOP-F01EMD3 MINGW64 /c/mathlib
$ git branch
  direct_sum
  faster
  lc/squeeze-simp
  master
* squeeze-simp
</pre></div>

#### [ Kenny Lau (Oct 07 2018 at 14:21)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350708):
<p>what is this</p>

#### [ Scott Morrison (Oct 07 2018 at 14:22)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350735):
<p>That sounds promising!</p>

#### [ Scott Morrison (Oct 07 2018 at 14:22)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350749):
<p>Let's get rid of your <code>lc/squeeze-simp</code> though.</p>

#### [ Scott Morrison (Oct 07 2018 at 14:22)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350753):
<p><code>git branch -d lc/squeeze-simp</code></p>

#### [ Scott Morrison (Oct 07 2018 at 14:22)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350755):
<p>(don't worry, there's no danger that will actually kill the one on community !)</p>

#### [ Kenny Lau (Oct 07 2018 at 14:23)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350766):
<div class="codehilite"><pre><span></span>$ git branch -D lc/squeeze-simp
Deleted branch lc/squeeze-simp (was cbbbd17).
</pre></div>

#### [ Scott Morrison (Oct 07 2018 at 14:23)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350768):
<p>great.</p>

#### [ Scott Morrison (Oct 07 2018 at 14:24)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350803):
<p><code>git merge --squash faster</code></p>

#### [ Scott Morrison (Oct 07 2018 at 14:24)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350807):
<p><code>git status</code></p>

#### [ Kenny Lau (Oct 07 2018 at 14:25)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350813):
<div class="codehilite"><pre><span></span>$ git merge --squash faster
Auto-merging tactic/squeeze.lean
CONFLICT (add/add): Merge conflict in tactic/squeeze.lean
Squash commit -- not updating HEAD
Automatic merge failed; fix conflicts and then commit the result.

$ git status
On branch squeeze-simp
Your branch is up-to-date with &#39;lc/squeeze-simp&#39;.
Changes to be committed:
  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)

        modified:   algebra/archimedean.lean
        modified:   algebra/big_operators.lean
        modified:   algebra/char_zero.lean
        modified:   algebra/euclidean_domain.lean
        modified:   algebra/field.lean
        modified:   algebra/field_power.lean
        modified:   algebra/gcd_domain.lean
        modified:   algebra/group.lean
        modified:   algebra/group_power.lean
        modified:   analysis/topology/topological_space.lean
        modified:   analysis/topology/uniform_space.lean
        modified:   computability/turing_machine.lean
        modified:   data/complex/basic.lean
        modified:   data/finset.lean
        modified:   data/finsupp.lean
        modified:   data/list/basic.lean
        modified:   data/multiset.lean
        modified:   data/polynomial.lean
        modified:   meta/rb_map.lean
        modified:   order/conditionally_complete_lattice.lean
        modified:   order/filter.lean
        modified:   order/lattice.lean
        modified:   set_theory/ordinal.lean
        modified:   tactic/tfae.lean
        modified:   tests/tactics.lean

Unmerged paths:
  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)
  (use &quot;git add &lt;file&gt;...&quot; to mark resolution)

        both added:      tactic/squeeze.lean
</pre></div>

#### [ Scott Morrison (Oct 07 2018 at 14:26)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350859):
<p>hmm!</p>

#### [ Kenny Lau (Oct 07 2018 at 14:26)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350864):
<p>(I can resolve the conflict myself)</p>

#### [ Scott Morrison (Oct 07 2018 at 14:26)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350865):
<p>have a look at <code>squeeze.lean</code>, and try to make it look like Simon's version, I guess</p>

#### [ Kenny Lau (Oct 07 2018 at 14:28)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350909):
<p>now what</p>

#### [ Scott Morrison (Oct 07 2018 at 14:30)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135350957):
<p><code>git status</code></p>

#### [ Kenny Lau (Oct 07 2018 at 14:32)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351015):
<div class="codehilite"><pre><span></span>$ git status
On branch squeeze-simp
Your branch is up-to-date with &#39;lc/squeeze-simp&#39;.
Changes to be committed:
  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)

        modified:   algebra/archimedean.lean
        modified:   algebra/big_operators.lean
        modified:   algebra/char_zero.lean
        modified:   algebra/euclidean_domain.lean
        modified:   algebra/field.lean
        modified:   algebra/field_power.lean
        modified:   algebra/gcd_domain.lean
        modified:   algebra/group.lean
        modified:   algebra/group_power.lean
        modified:   analysis/topology/topological_space.lean
        modified:   analysis/topology/uniform_space.lean
        modified:   computability/turing_machine.lean
        modified:   data/complex/basic.lean
        modified:   data/finset.lean
        modified:   data/finsupp.lean
        modified:   data/list/basic.lean
        modified:   data/multiset.lean
        modified:   data/polynomial.lean
        modified:   meta/rb_map.lean
        modified:   order/conditionally_complete_lattice.lean
        modified:   order/filter.lean
        modified:   order/lattice.lean
        modified:   set_theory/ordinal.lean
        modified:   tactic/squeeze.lean
        modified:   tactic/tfae.lean
        modified:   tests/tactics.lean
</pre></div>

#### [ Scott Morrison (Oct 07 2018 at 14:32)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351020):
<p><code>git commit -m "nice message here"</code></p>

#### [ Scott Morrison (Oct 07 2018 at 14:32)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351021):
<p>no no!</p>

#### [ Scott Morrison (Oct 07 2018 at 14:33)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351024):
<p>oops, sorry we want to make a new branch first :-)</p>

#### [ Scott Morrison (Oct 07 2018 at 14:33)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351028):
<p>so <code>git branch faster2</code></p>

#### [ Kenny Lau (Oct 07 2018 at 14:33)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351029):
<p>eh... I already committed</p>

#### [ Scott Morrison (Oct 07 2018 at 14:33)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351032):
<p>okay :-)</p>

#### [ Kenny Lau (Oct 07 2018 at 14:33)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351033):
<p>how do I reverse the commit?</p>

#### [ Kenny Lau (Oct 07 2018 at 14:33)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351038):
<p>can I just delete this branch and redo it?</p>

#### [ Mario Carneiro (Oct 07 2018 at 14:34)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351079):
<p><code>git reset HEAD~</code> should work</p>

#### [ Kenny Lau (Oct 07 2018 at 14:35)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351087):
<p>nice</p>

#### [ Kenny Lau (Oct 07 2018 at 14:37)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351133):
<div class="codehilite"><pre><span></span>$ git add .

$ git branch faster2

$ git branch
  direct_sum
  faster
  faster2
  master
* squeeze-simp
</pre></div>

#### [ Scott Morrison (Oct 07 2018 at 14:37)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351134):
<p>Do you think you can take it from here, Kenny? I have to head off.</p>

#### [ Kenny Lau (Oct 07 2018 at 14:37)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351135):
<p>eh...</p>

#### [ Kenny Lau (Oct 07 2018 at 14:37)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351136):
<p>kind of confused</p>

#### [ Scott Morrison (Oct 07 2018 at 14:38)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351174):
<p><code>git checkout faster2</code></p>

#### [ Scott Morrison (Oct 07 2018 at 14:38)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351177):
<p><code>git commit -m "refactor(*): making mathlib faster"</code></p>

#### [ Kenny Lau (Oct 07 2018 at 14:39)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351186):
<p>and then?</p>

#### [ Scott Morrison (Oct 07 2018 at 14:39)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351188):
<p><code>git branch -d faster</code></p>

#### [ Scott Morrison (Oct 07 2018 at 14:39)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351189):
<p>probably get an error message, because it's not fully merged</p>

#### [ Scott Morrison (Oct 07 2018 at 14:39)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351190):
<p>so</p>

#### [ Scott Morrison (Oct 07 2018 at 14:39)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351191):
<p><code>git branch -D faster</code></p>

#### [ Scott Morrison (Oct 07 2018 at 14:39)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351193):
<p>to force it to delete</p>

#### [ Scott Morrison (Oct 07 2018 at 14:40)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351231):
<p><code>git branch -m faster2 faster</code></p>

#### [ Scott Morrison (Oct 07 2018 at 14:40)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351237):
<p>to rename faster2 to faster</p>

#### [ Scott Morrison (Oct 07 2018 at 14:40)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351239):
<p>and finally <code>git push --force lc</code></p>

#### [ Scott Morrison (Oct 07 2018 at 14:41)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135351247):
<p>Good luck! I'll have a look when I get up to see how you went. :-)</p>

#### [ Kenny Lau (Oct 07 2018 at 16:47)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135354608):
<blockquote>
<p>Kenny could you not replace <code>induction</code> with <code>nat.rec_on</code>? It's less readable</p>
</blockquote>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> can I use <code>match</code>?</p>

#### [ Kenny Lau (Oct 07 2018 at 19:53)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135360399):
<p><a href="https://github.com/leanprover/mathlib/pull/391" target="_blank" title="https://github.com/leanprover/mathlib/pull/391">done</a></p>

#### [ Simon Hudon (Oct 08 2018 at 00:24)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135368048):
<p>Do you intend to do all your speed up before merging your branch? I think there's a benefit to merging regularly</p>

#### [ Kenny Lau (Oct 08 2018 at 00:32)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135368287):
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span> I don't understand your question</p>

#### [ Kenny Lau (Oct 08 2018 at 00:32)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135368288):
<p>I can't control when my PR is merged</p>

#### [ Simon Hudon (Oct 08 2018 at 00:33)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135368297):
<p>Yes, you have control. If you keep making commits to the same branch and don't ask <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> and <span class="user-mention" data-user-id="110294">@Johannes Hölzl</span> to merge, they won't merge.</p>

#### [ Kenny Lau (Oct 08 2018 at 00:35)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135368348):
<p>Mario asked me to not use <code>nat.rec_on</code>, so I changed <code>nat.rec_on</code> to <code>by induction</code> and pushed.</p>

#### [ Kenny Lau (Oct 08 2018 at 00:35)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135368351):
<p>also why are we on this thread?</p>

#### [ Kenny Lau (Oct 08 2018 at 00:35)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135368355):
<p>so I don't see what I should have done instead.</p>

#### [ Simon Hudon (Oct 08 2018 at 00:48)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135368779):
<p>What I'm asking you is when do you intend for <code>faster</code> to get merged.</p>

#### [ Kenny Lau (Oct 08 2018 at 00:49)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135368804):
<p>well, now, preferably</p>

#### [ Kenny Lau (Oct 08 2018 at 00:49)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135368808):
<p>but I don't know what I can do.</p>

#### [ Simon Hudon (Oct 08 2018 at 00:50)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135368855):
<p>Cool, thanks</p>

#### [ Kenny Lau (Oct 08 2018 at 00:50)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135368860):
<p>could you move this discussion to the faster thread?</p>

#### [ Kenny Lau (Oct 08 2018 at 00:55)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135368970):
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span> so what should I do now?</p>

#### [ Simon Hudon (Oct 08 2018 at 00:58)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135369071):
<p>Nothing different. I didn't realize that you were trying to get it merged</p>

#### [ Mario Carneiro (Oct 08 2018 at 11:35)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135391043):
<p>I notice you worked on <code>turing_machine.lean</code>. While I applaud your effort, I think it was probably not a good choice. The theorems there are still under construction, as it were; I'm not certain that they will keep their current form, and if so the original proofs with <code>simp</code> will be more robust to changes. Moreover, those proofs are very CSy in the sense that they are proving simple properties of complicated objects; it is in this situation where <code>simp</code> has the biggest advantage, and the proofs without it are much longer and more brittle.</p>
<p>I will accept the changes since the file is on mathlib and everyone feels the compilation overhead (at least, if they are compiling everything in mathlib - it's not a dependent of any other files), but probably I should move the file out of mathlib altogether.</p>

#### [ Mario Carneiro (Oct 08 2018 at 14:49)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135400485):
<p>Oof, I was going well through the PR, and then I see this:<br>
<a href="https://github.com/leanprover/mathlib/pull/391/files#diff-21d78f94c9e397a3a2d037174c0903d6R18" target="_blank" title="https://github.com/leanprover/mathlib/pull/391/files#diff-21d78f94c9e397a3a2d037174c0903d6R18">https://github.com/leanprover/mathlib/pull/391/files#diff-21d78f94c9e397a3a2d037174c0903d6R18</a></p>
<p>What is this? There is no way this huge list will make it in to mathlib</p>

#### [ Johan Commelin (Oct 08 2018 at 14:52)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135400637):
<p>"with multiset" occurs 148 times on that page.</p>

#### [ Johan Commelin (Oct 08 2018 at 14:52)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135400643):
<p>Also, I think you should ping <span class="user-mention" data-user-id="110064">@Kenny Lau</span></p>

#### [ Mario Carneiro (Oct 08 2018 at 14:53)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135400663):
<p>I know, it gets used everywhere</p>

#### [ Mario Carneiro (Oct 08 2018 at 14:54)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135400707):
<p>I don't see the point in adding the kitchen sink to a simp set, that's just reinventing the default simp set</p>

#### [ Kenny Lau (Oct 08 2018 at 14:54)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135400720):
<p>that was added by <span class="user-mention" data-user-id="110026">@Simon Hudon</span> to test an alternative way to reducing build time, i.e. by using simp attr</p>

#### [ Johan Commelin (Oct 08 2018 at 14:55)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135400733):
<p>From the profile gist: <code>data/multiset.lean 99.3 --&gt; 42.9 (Kenny)</code></p>

#### [ Kenny Lau (Oct 08 2018 at 14:57)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135400838):
<p>look at the history</p>

#### [ Johan Commelin (Oct 08 2018 at 14:58)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135400887):
<p>I mostly wanted to point out the speed-up, not the guy behind it (-;</p>

#### [ Mario Carneiro (Oct 08 2018 at 14:58)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135400891):
<p>okay, but that's a separate PR</p>

#### [ Mario Carneiro (Oct 08 2018 at 15:02)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135401088):
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span> Could you extract the bits from the PR about the <code>multiset</code> simp set?</p>

#### [ Simon Hudon (Oct 08 2018 at 16:28)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135406953):
<p>Actually, the best might just be to redo the work with <code>squeeze_simp</code>. That was before I wrote it and I was trying to leave the proofs mostly unchanged. I think <code>squeeze_simp</code> is better at this.</p>

#### [ Mario Carneiro (Oct 08 2018 at 20:33)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135420706):
<p>The <code>faster</code> branch has been merged... mostly. The <code>multiset</code> file should be done without that simp set thing</p>

#### [ Johan Commelin (Oct 08 2018 at 20:37)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135420916):
<p>Thank you very much <span class="user-mention" data-user-id="110064">@Kenny Lau</span>  and <span class="user-mention" data-user-id="110049">@Mario Carneiro</span></p>

#### [ Johan Commelin (Oct 08 2018 at 20:37)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135420930):
<p>I think it would be good to draw some lessons from this experience, before diving into the next 10 files.</p>

#### [ Johan Commelin (Oct 08 2018 at 20:38)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135420982):
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> What are your thoughts and feelings about this battle?</p>

#### [ Johan Commelin (Oct 08 2018 at 20:39)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421005):
<p>Are we sacrificing too much readability for speed? Should we look for other methods of increasing speed?</p>

#### [ Mario Carneiro (Oct 08 2018 at 20:39)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421008):
<p>It took me a while to read all the proofs, and I'm sure Kenny learned a lot of math by osmosis</p>

#### [ Johan Commelin (Oct 08 2018 at 20:39)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421036):
<p>Your end goal is to "golf all of maths". Does this fit in well?</p>

#### [ Mario Carneiro (Oct 08 2018 at 20:40)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421037):
<p>Honestly, once I got used to the constraints it was like I'm doing metamath again, trying to minimize a <em>proof</em> not a proof script</p>

#### [ Mario Carneiro (Oct 08 2018 at 20:40)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421088):
<p>but I'm sure the thought of that does not appeal to most here</p>

#### [ Johan Commelin (Oct 08 2018 at 20:41)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421119):
<p>Do we have a choice?</p>

#### [ Johan Commelin (Oct 08 2018 at 20:41)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421155):
<p>Or is mathlib going to grind to a halt in a couple of months if we don't adapt to this spartan way of proofwriting?</p>

#### [ Mario Carneiro (Oct 08 2018 at 20:41)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421167):
<p>I think that I will not change the way we write proofs. I prefer the big sweep</p>

#### [ Mario Carneiro (Oct 08 2018 at 20:42)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421228):
<p>I think we should focus more on early files though</p>

#### [ Mario Carneiro (Oct 08 2018 at 20:42)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421244):
<p>i.e. it doesn't matter if <code>turing_machine</code> is slow, no one imports it</p>

#### [ Mario Carneiro (Oct 08 2018 at 20:43)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421273):
<p>but having basic files like <code>order.filter</code> being slow was a killer</p>

#### [ Kevin Buzzard (Oct 08 2018 at 20:44)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421343):
<blockquote>
<p>i.e. it doesn't matter if <code>turing_machine</code> is slow, no one imports it</p>
</blockquote>
<p>I always build everything, just to make life easy.</p>

#### [ Mario Carneiro (Oct 08 2018 at 20:45)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421377):
<p>Sure, but in that case you are already geared for a long compile</p>

#### [ Chris Hughes (Oct 08 2018 at 20:45)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421382):
<p>That doesn't help when you're writing a PR, and you change <code>nat.basic</code></p>

#### [ Johan Commelin (Oct 08 2018 at 20:46)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421432):
<p>Well, if this big sweep goes on like it does, then "long compile" could be 10 minutes, instead of 60.</p>

#### [ Mario Carneiro (Oct 08 2018 at 20:47)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421452):
<p>Of course I suggested to go for the low hanging fruits first, the next third of compile time probably will be more work still</p>

#### [ Johan Commelin (Oct 08 2018 at 20:48)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421529):
<p>Anyway, does Github show which PR's have merge conflicts after this refactor?</p>

#### [ Johan Commelin (Oct 08 2018 at 20:49)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421548):
<p>Or does Chris have to write all of <code>exp</code> all over again [kidding] <span class="emoji emoji-1f643" title="upside down">:upside_down:</span></p>

#### [ Kenny Lau (Oct 08 2018 at 20:57)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135421872):
<p>Muito obrigado <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> .</p>

#### [ Bryan Gin-ge Chen (Oct 08 2018 at 21:34)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135423561):
<p><code>linear_algebra/dimension.lean</code> was broken by the merge <span class="user-mention" data-user-id="110049">@Mario Carneiro</span></p>

#### [ Kenny Lau (Oct 08 2018 at 21:40)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135423935):
<p>and an extra import of <code>tactic.squeeze</code> in <code>algebra/big_operators.lean</code> as pointed out by Simon</p>

#### [ Patrick Massot (Oct 08 2018 at 21:42)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23391%20faster/near/135424021):
<blockquote>
<p><code>linear_algebra/dimension.lean</code> was broken by the merge <span class="user-mention" data-user-id="110049">@Mario Carneiro</span></p>
</blockquote>
<p>That file will be module-refactored anyway</p>


{% endraw %}
