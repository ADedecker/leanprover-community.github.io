---
layout: page
title: Lean Prover Zulip Chat Archive 
permalink: archive/144837PRreviews/62537352fincases.html
---

## Stream: [PR reviews](https://leanprover-community.github.io/archive/144837PRreviews/index.html)
### Topic: [#352 fin_cases](https://leanprover-community.github.io/archive/144837PRreviews/62537352fincases.html)

---

<base href="https://leanprover.zulipchat.com">
{% raw %}
#### [ Scott Morrison (Oct 08 2018 at 10:02)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135386568):
<p>I've just finished up <a href="https://github.com/leanprover/mathlib/issues/352" target="_blank" title="https://github.com/leanprover/mathlib/issues/352">#352</a>, a tactic called <code>fin_cases</code>. It's intended use is <code>fin_cases h</code>, where <code>h : fin n</code> for some numeral <code>n</code>. It just performs case bashing.</p>
<p>The demo is:</p>
<div class="codehilite"><pre><span></span>example (f : ℕ → Prop) (p : fin 3) (h0 : f 0) (h1 : f 1) (h2 : f 2) : f p.val :=
begin
  fin_cases p,
  all_goals { assumption }
end
</pre></div>


<p>After <code>fin_cases p</code>, there are three goals, <code>f 0</code>, <code>f 1</code>, and <code>f 2</code>.</p>

#### [ Scott Morrison (Oct 08 2018 at 10:07)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135386817):
<p>It's not super clear that it's actually useful. :-) A generalisation to <code>fintype</code> might be fun, although I'm not particularly sure how to implement that one.</p>

#### [ Scott Morrison (Oct 08 2018 at 10:07)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135386826):
<p>Similarly tactics for expanding finite sums out into explicit sums might be useful.</p>

#### [ Mario Carneiro (Oct 08 2018 at 10:11)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135387043):
<p>I wonder whether we can extend this to all fintypes</p>

#### [ Mario Carneiro (Oct 08 2018 at 10:12)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135387109):
<p>How to implement it? well, you can use apply_instance to get a proof that it is a fintype, then whnf the result to get a list of explicit terms to use</p>

#### [ Scott Morrison (Oct 08 2018 at 11:51)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135391720):
<p>I'm not sure what to do with this. I'm not particularly interested in doing those generalisations right now. We should decide:<br>
1) merge with the current functionality (but perhaps fixes)<br>
2) find someone to take over and generalise<br>
3) close<br>
I'm happy with any of these.</p>

#### [ Mario Carneiro (Oct 08 2018 at 11:52)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135391773):
<p>I will do (1), with the possibility of (2) later. I just wanted the idea on the table</p>

#### [ Mario Carneiro (Oct 08 2018 at 11:52)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135391797):
<p>Do we need even the current version?</p>

#### [ Mario Carneiro (Oct 08 2018 at 11:52)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135391804):
<p>I guess Kevin likes to come up with theorems that require case bashing</p>

#### [ Scott Morrison (Oct 08 2018 at 11:57)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135391991):
<p>I wrote it just as a warmup for the fintype version, which I genuinely wanted.</p>

#### [ Mario Carneiro (Oct 08 2018 at 12:02)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135392292):
<p>oh? do you have an example?</p>

#### [ Scott Morrison (Oct 08 2018 at 12:05)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135392374):
<p>Hrm, it was way out in category theory land, where I was showing that if you have limits, then you have equalizers. I had written something that constructed a diagram (a category and a functor out of it) just by giving a list of edges and the morphisms they should be sent to. This gadget has lots of <code>fin n</code>s describing the objects and homs, etc. I forget exactly what it was, but checking something about the limit/equalizer relationship seemed achievable by just case bashing.</p>

#### [ Scott Morrison (Oct 08 2018 at 12:06)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135392435):
<p>(Of course it would be possible to prove limits =&gt; equalizers more directly, but I wanted to explore building diagrams just by "drawing the diagram" rather than custom inductive types.)</p>

#### [ Scott Morrison (Oct 08 2018 at 12:06)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135392449):
<p>I can try to make this into a MWE, but it's probably not reasonable to do so until my work on limits lands. (Which will be shortly after <code>back</code> lands. :-)</p>

#### [ Mario Carneiro (Oct 08 2018 at 12:16)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135392920):
<p>I think Reid and I discussed some options for "walking categories" with you in Orsay</p>

#### [ Mario Carneiro (Oct 08 2018 at 12:17)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135392930):
<p>involving small inductive types</p>

#### [ Scott Morrison (Oct 08 2018 at 12:34)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135393741):
<p>I wanted even cheaper options, with no inductive types at all. E.g. to be able to write: <code>diagram [(0,1,f), (0,1,g)]</code> to get the category with two parallel arrows, and the functor out of it sending those arrows to some morphisms <code>f</code> and <code>g</code>.</p>

#### [ Scott Morrison (Oct 08 2018 at 12:35)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135393761):
<p>(Here <code>diagram</code> is a tactic, that doesn't exist at this level of generality.)</p>

#### [ Johan Commelin (Oct 08 2018 at 12:35)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135393767):
<p>Maybe we could have some sort of diagram combinators</p>

#### [ Scott Morrison (Oct 08 2018 at 12:35)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135393772):
<p>Even better would be to just write <code>diagram [f, g]</code>, and have the tactic work out that since they have the same source and target we want a functor out of the walking parallel pair.</p>

#### [ Mario Carneiro (Oct 08 2018 at 12:43)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135394119):
<p>is there a reason the set of objects here can't just be <code>nat</code>?</p>

#### [ Mario Carneiro (Oct 08 2018 at 12:44)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135394164):
<p>If we are constructing a free category then only the homs matter</p>

#### [ Scott Morrison (Oct 08 2018 at 12:45)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135394201):
<p>But we're defining a functor out of it. Where do all the other objects go?</p>

#### [ Mario Carneiro (Oct 08 2018 at 12:49)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135394343):
<p>okay, I see. So something like <code>diagram [A, f, g]</code> could build a diagram supported on the objects and homs in the list</p>

#### [ Mario Carneiro (Oct 08 2018 at 12:50)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135394397):
<p>what would this be used for?</p>

#### [ Mario Carneiro (Oct 08 2018 at 12:50)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135394412):
<p>I would assume that the point of connecting a configuration of arrows to a diagram from a walking category is to relate it to other such diagrams</p>

#### [ Mario Carneiro (Oct 08 2018 at 12:51)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135394434):
<p>but if you call <code>diagram</code> everytime and get a different walking category every time then that doesn't work</p>

#### [ Johan Commelin (Oct 08 2018 at 12:52)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135394479):
<p>I think we want ways to say: Look, we've got these morphisms. The following diagram commutes.</p>

#### [ Mario Carneiro (Oct 08 2018 at 12:53)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135394494):
<p>Ah! so this is a way of making diagram chasing decidable</p>

#### [ Kevin Buzzard (Oct 08 2018 at 17:04)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135409536):
<p>When I was a PhD student I was doing some EGA-style algebraic geometry involving representability and pullbacks and what-have-you, and I ran into the following problem. I had a diagram on a piece of paper with lots of arrows everywhere, and I knew that "it commuted". I then wanted to add one more arrow in and claim that "it still commutes". I realised I was not entirely sure what I needed to check.</p>

#### [ Kevin Buzzard (Oct 08 2018 at 17:05)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135409550):
<p>After further thought I realised that perhaps I was not even entirely sure what I meant by a diagram commuting -- or even by a diagram.</p>

#### [ Kevin Buzzard (Oct 08 2018 at 17:05)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135409568):
<p>Presumably this sort of problem is completely understood? I am still not sure I understand exactly what is going on here.</p>

#### [ Kevin Buzzard (Oct 08 2018 at 17:06)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135409636):
<p>I came up with definitions such as "if A and B are objects in the diagram then every way of defining a morphism from A to B using only composition and functions in the diagram, is the same way"</p>

#### [ Kevin Buzzard (Oct 08 2018 at 17:07)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135409653):
<p>Are all of those morphisms supposed to be part of my diagram? I don't usually draw them.</p>

#### [ Mario Carneiro (Oct 08 2018 at 17:10)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135409753):
<p>The official definition says that every path between two points yields equal compositions</p>

#### [ Mario Carneiro (Oct 08 2018 at 17:11)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135409833):
<p>But at least in the case where the graph is acyclic (which most category theory graphs are), it reduces to checking all cycles in the graph</p>

#### [ Mario Carneiro (Oct 08 2018 at 17:11)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135409855):
<p>where there is one source and one sink in the cycle, i.e. <code>A -&gt; ... -&gt; B &lt;- ... &lt;- A</code></p>

#### [ Kevin Buzzard (Oct 08 2018 at 17:13)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135409988):
<p>I see. The loop is just the degenerate case <code>A = B</code> somehow. I agree, loops very rarely came up in category theory.</p>

#### [ Mario Carneiro (Oct 08 2018 at 17:13)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135410003):
<p>well, you could have <code>A -&gt; B -&gt; A</code></p>

#### [ Mario Carneiro (Oct 08 2018 at 17:13)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135410012):
<p>and then "it commutes" implies this is an isomorphism</p>

#### [ Kevin Buzzard (Oct 08 2018 at 17:14)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135410078):
<p>I guess "it commutes" really means "start at any point in the loop, go once round, and check you are the identity map". So it's one check per number of nodes maybe</p>

#### [ Mario Carneiro (Oct 08 2018 at 17:30)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135411040):
<p>wikipedia says check every polygonal subgraph, which is the same, but both are a bit redundant. I think you can say this: if the graph is planar with source and sink on the outside, then it suffices to check only polygons that are faces in the embedding</p>

#### [ Kevin Buzzard (Oct 08 2018 at 18:58)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135415963):
<p>Mine were often not planar. I would sometimes have to consider the pullback of a commutative square along a diagram, making a "commutative cube". Actually that _is_ planar isn't it -- I just never drew it that way :-)</p>

#### [ Kevin Buzzard (Oct 08 2018 at 18:58)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135415967):
<p>But I certainly had examples which were not planar.</p>

#### [ Mario Carneiro (Oct 08 2018 at 18:59)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135415995):
<p>If you can decompose the graph into multiple planar bits you can check each bit</p>

#### [ Mario Carneiro (Oct 08 2018 at 18:59)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135416002):
<p>for example if you have a cube you can get the three faces in the front and three in the back</p>

#### [ Mario Carneiro (Oct 08 2018 at 19:01)](https://leanprover.zulipchat.com/#narrow/stream/144837-PR%20reviews/topic/%23352%20fin_cases/near/135416092):
<p>The cube usually isn't planar in the sense I described - it is important that the source and sink be both on the outside, and if they are opposite corners of the cube then you can't draw it so that this happens</p>


{% endraw %}
